#########################################################################################################
# Ejecutar tests unitarios en la rama en la que se hace push.
# Solo se ejecuta en develop y master, salvo que se defina $TEST_AUX_BRANCHES
#
# Vers  Por Fecha      Notas
# ----- --- ---------- ----------------------------------------------------------------------------------
# 1.0.0 FNG 26/07/2022 Version inicial
#
#########################################################################################################
compile-job:
  stage: compile

  rules:
    # Siempre compilamos ramas principales
    - IF: $CI_COMMIT_REF_NAME == "develop" || $CI_COMMIT_REF_NAME == "master"
    # Compilamos cualquier otro branch dependiendo del correspondiente flag
    - IF: $TEST_AUX_BRANCHES == "true"
    
  cache:
    paths:
      - ./.m2/repository
      - target

  script:
    - 'echo "=============================================================================================="'
    - 'echo "Ejecutando etapa TEST en $CI_COMMIT_REF_NAME"'
    - 'echo "=============================================================================================="'
    - mvn test