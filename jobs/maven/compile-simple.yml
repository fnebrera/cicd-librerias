#########################################################################################################
# Compilar proyecto maven para ver que no hay errores. Se ejecuta para cualquier push,
# y siempre antes de cualquier otro job que requiera conocer la version del proyecto.
#
# Vers  Por Fecha      Notas
# ----- --- ---------- ----------------------------------------------------------------------------------
# 1.0.0 FNG 26/07/2022 Version inicial
#
#########################################################################################################
compile-job:
  stage: compile

  rules:
    # Siempre compilamos ramas principales.
    # Tambien compilamos cualquier otro branch dependiendo del correspondiente flag,
    # salvo que tambien se requiera ejecutar tests, en cuyo caso el compilar esta implicito.
    - IF: $CI_COMMIT_REF_NAME == "develop" || $CI_COMMIT_REF_NAME == "master"
    - IF: $COMPILE_AUX_BRANCHES == "true" #&& $TEST_AUX_BRANCHES == "false"
    
  cache:
    paths:
      - ./.m2/repository
      - target

  script:
    - 'echo "=============================================================================================="'
    - 'echo "Ejecutando etapa COMPILE en $CI_COMMIT_REF_NAME"'
    - 'echo "=============================================================================================="'
    - mvn compile
