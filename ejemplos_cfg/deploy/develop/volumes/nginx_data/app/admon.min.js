function ausExport(){oExp=new Form("Seleccione mes",305,145),Label(oExp,50,20,"Año"),oEAnno=new ComboBox(oExp,50,60,["2019","2020","2021","2022"],["2019","2020","2021","2022"],0),Label(oExp,50,140,"Mes"),oEMes=new ComboBox(oExp,50,180,["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["1","2","3","4","5","6","7","8","9","10","11","12"],0),oEPrint=new Button(oExp,100,20,"Aceptar","ausExportView(oEAnno, oEMes)"),oEExit=new Button(oExp,100,160,"Salir","oExp.release()"),oExp.fadeIn()}function ausExportView(e,t){var o=window.open("");if(o){var a=e.getSelectedValue(),i=t.getSelectedValue(),r=httpRequest(sRequestAdmaus,"AUSEXPORT",sUsuario,a,i);if(!esUnError(r)){nLineaHtml=0,aHtml=[],aHtml[++nLineaHtml]="<html>",aHtml[++nLineaHtml]="<head>",aHtml[++nLineaHtml]="<title>Resumen de ausencias y solictudes</title>",aHtml[++nLineaHtml]="</head>",aHtml[++nLineaHtml]="<body>";for(var n=0;n<r.length;n++)aHtml[++nLineaHtml]=r[n]+"<br>";aHtml[++nLineaHtml]="</body></html>";var s=aHtml.join("");o.document.write(s),o.document.close()}}else alert("No se ha podido abrir la nueva ventana")}function ayudaGenerico(e){if(null!=e){var t=e.name;if(t&&"hlp"==t.substr(0,3)&&(nAGcontrol=parseInt(t.substr(3)),"A"==aMGDefine[nAGcontrol][6])){var o=aMGDefine[nAGcontrol][7];if(o){var a=o.split(":");if(4==a.length){var i=a[0],r=a[1].split(",");nAGCampo=r.length;var n=r.concat(a[2].split(",")),s=a[3];if("N"==a[3])s="";else{var l=s.indexOf("@");if(-1<l){var d,c;c=-1<(d=s.indexOf(" ",l+1))?s.substring(l,d):s.substring(l);var u=parseInt(c.substring(1));s=s.replace(c,"'"+aControl[u].getValue()+"'")}}0<s.length&&(s=" where "+s);var m="select "+n+" from "+i+s+" order by "+a[1],g=httpRequest(sRequestDb,"DBSELECT",sUsuario,m);if(!esUnError(g)){oWinHlp=new Form(i,465,270),oGridHlp=new Grid(oWinHlp,40,15,430,150,n,410,!0,"ayudaGenericoClick()"),oSelHlp=new Button(oWinHlp,210,90,"Seleccionar","ayudaGenericoSelect(nAGcontrol, nAGCampo)"),Button(oWinHlp,210,220,"Salir","oWinHlp.release()");for(var b=0;b<g.length;b++)oGridHlp.addRow(g[b]);oWinHlp.fadeIn()}}}}}}function ayudaGenericoClick(){0<oGridHlp.getSelectedRowCount()?oSelHlp.enable():oSelHlp.disable()}function ayudaGenericoSelect(e,t){var o=getSeleccion(oGridHlp);o<0||(aControl[e].setValue(oGridHlp.getCell(o,t)),oWinHlp.release())}function borrarParte(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0)alert("Opcion reservada para Administración");else{var e=120,t=50;oBWin=new Form("Eliminar un Parte",300,260),Label(oBWin,t,25,"Siglas"),oBSig=new TextBox(oBWin,t,e,"",!1,"forzarMayusculas(this)"),oBSig.setWidth(char2pixel(3)),t+=30,Label(oBWin,t,25,"Año"),oBAnno=new ComboBox(oBWin,t,e,["2019","2020","2021","2022"],["2019","2020","2021","2022"],0,"borrarParteFillSem()"),ponAnnoActual(oBAnno),t+=30,Label(oBWin,t,25,"Mes"),oBMes=new ComboBox(oBWin,t,e,["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["1","2","3","4","5","6","7","8","9","10","11","12"],0,"borrarParteFillSem()"),ponMesActual(oBMes),t+=30,Label(oBWin,t,25,"Semana"),oBSem=new ComboBox(oBWin,t,e,"","",0),borrarParteFillSem(),t+=40,oBVer=new Button(oBWin,t,25,"Ver","borrarParteVer()"),oBElim=new Button(oBWin,t,155,"Eliminar","borrarParteGo()"),t+=40,oBSalir=new Button(oBWin,t,85,"Salir","oBWin.release()"),oBWin.fadeIn()}else alert("No has hecho login")}function borrarParteFillSem(){buscarSemanas(oBAnno,oBMes,oBSem)}function borrarParteVer(){var e=oBSig.getValue(),t=oBAnno.getSelectedValue(),o=oBMes.getSelectedValue(),a=oBSem.getSelectedValue();!e||!a||3!=e.length||parseInt(a)<1?alert("Debes rellenar todos los campos"):entrarPartes(t,o,a,e,!0)}function borrarParteGo(){var e=oBSig.getValue(),t=oBAnno.getSelectedValue(),o=oBMes.getSelectedValue(),a=oBSem.getSelectedValue();if(!e||!a||3!=e.length||parseInt(a)<1)alert("Debes rellenar todos los campos");else if(confirm("El parte "+e+"-"+t+"-"+o+"-"+a+" será eliminado permanentemente de la BD, lo que puede generar inconsistencias y pérdidas de información.\n¿Estás seguro de continuar?")){var i=httpRequest(sRequestPartes,"BORPARTE",sUsuario,t,o,a,e);esUnError(i)||(alert("Se ha eliminado el parte de "+e+" conteniendo "+i[0].toString()+" lineas"),oWin.release())}}function cambioAnno(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("TODO")<0)alert("Opción reservada para Dirección Financiera");else{var e=40,t=30,o=20,a=300;oCAWin=new Form("Procesos cambio de Año",370,330),Label(oCAWin,e,o,"Año origen","red"),oCAAnnoO=new ComboBox(oCAWin,e,100,["2015","2016","2017","2018","2019","2020","2021","2022","2023"],["2015","2016","2017","2018","2019","2020","2021","2022","2023"],0),ponAnnoActual(oCAAnnoO),Label(oCAWin,e,180,"Calendario base","red"),oCACalenO=new TextBox(oCAWin,e,a,"CC",!1,""),oCACalenO.setWidth(40),e+=t,Label(oCAWin,e,o,"Año destino","red"),oCAAnnoD=new ComboBox(oCAWin,e,100,["2015","2016","2017","2018","2019","2020","2021","2022","2023"],["2015","2016","2017","2018","2019","2020","2021","2022","2023"],1),oCAAnnoD.setIndexByValue(((new Date).getFullYear()+1).toString()),e+=t,Label(oCAWin,e,o,"Clonar calendarios"),oCAClonCal=new Button(oCAWin,e,a,"Go!","oCAClonarCal()",40,20),e+=t,Label(oCAWin,e,o,"Generar tabla de semanas"),oCATabSem=new Button(oCAWin,e,a,"Go!","oCATablaSem()",40,20),e+=t,Label(oCAWin,e,o,"Recalcular coste directo de todas personas"),oCARecalcCD=new Button(oCAWin,e,a,"Go!","oCARecalcularCD()",40,20),e+=t,Label(oCAWin,e,o,"Recalcular costes medios por categoría"),oCARecalcCMC=new Button(oCAWin,e,a,"Go!","oCARecalcularCMC()",40,20),e+=t,Label(oCAWin,e,o,"Calcular vacaciones a inicio de año"),oCACalcVacas=new Button(oCAWin,e,a,"Go!","oCACalcularVacas()",40,20),e+=t,Label(oCAWin,e,o,"Verificar integridad referencial de la BD"),oCAVerifInteg=new Button(oCAWin,e,a,"Go!","verifIntegClick()",40,20),e+=40,Button(oCAWin,e,120,"Salir","oCAWin.release()"),oCAWin.fadeIn()}else alert("No has hecho login")}function oCATablaSem(){var e=trim(oCACalenO.getValue());if(e.length<1)alert("Debes indicar el calendario origen");else{var t=httpRequest(sRequestDb,"DBCOUNT",sUsuario,"semanas","anno="+oCAAnnoD.getSelectedValue());esUnError(t)||0<parseInt(t[0])&&!confirm("La tabla ya contiene semanas del año "+oCAAnnoD.getSelectedValue()+"\n¿Estás seguro de continuar?")||(t=httpRequest(sRequestProcesp,"GENTABSEM",sUsuario,e,oCAAnnoD.getSelectedValue()),esUnError(t)||alert("Proceso finalizado con éxito"))}}function oCAClonarCal(){var e=httpRequest(sRequestDb,"DBCOUNT",sUsuario,"calendar","anno="+oCAAnnoO.getSelectedValue());if(!esUnError(e))if(parseInt(e[0])<1)alert("No se encuentran calendarios para el año origen");else if(e=httpRequest(sRequestDb,"DBCOUNT",sUsuario,"calendar","anno="+oCAAnnoD.getSelectedValue()),!esUnError(e)&&(!(0<parseInt(e[0]))||confirm("La tabla ya contiene calendarios del año "+oCAAnnoD.getSelectedValue()+"\n¿Estás seguro de continuar?"))){e=httpRequest(sRequestProcesp,"CLONCALEN",sUsuario,oCAAnnoO.getSelectedValue(),oCAAnnoD.getSelectedValue());esUnError(e)||alert("Proceso finalizado con éxito")}}function oCARecalcularCD(){if(confirm("Esta opción sólo es necesaria si se han modificado los datos de cálculo de costes de Seguridad Social.\n¿Estás seguro de continuar?")){var e=httpRequest(sRequestProcesp,"RECALCD",sUsuario);esUnError(e)||alert("Proceso finalizado con éxito. Registros tratados: "+e[0])}}function oCARecalcularCMC(){if(confirm("Esta opción sólo es necesaria si se han modificado los costes de algún colaborador.\n¿Estás seguro de continuar?")){var e=httpRequest(sRequestProcesp,"RECALCMC",sUsuario);esUnError(e)||alert("Proceso finalizado con éxito. Registros tratados: "+e[0])}}function oCACalcularVacas(){if(confirm("Este proceso debe realizarse sólo UNA vez al año. Si hubiese errores sólo se podrán revertir con ayuda del Administrador del Sistema.\n¿Estás seguro de continuar?")){var e=(new Date).getFullYear()-1,t="canno='"+e.toString()+"' and tipo='V' and estado!='DI'",o=httpRequest(sRequestDb,"DBCOUNT",sUsuario,"regvac",t);esUnError(o)||0<parseInt(o[0])&&!confirm("En el año "+e.toString()+" quedan vacaciones solicitadas y no disfrutadas.\n¿Estás seguro de continuar?")||(o=httpRequest(sRequestProcesp,"CALCVAC",sUsuario),esUnError(o)||alert("Proceso finalizado con éxito. Registros tratados: "+o[0]))}}function verifIntegClick(){confirm("Se van a verificar los partes desde el año "+oCAAnnoO.getSelectedValue()+".\n¿Estás seguro de continuar?")&&(trabajando(!0),setTimeout(function(){var e=oCAAnnoO.getSelectedValue(),t=httpRequest(sRequestProcesp,"VERIFINTEG",sUsuario,e);trabajando(!1),esUnError(t)||(1!=t.length||"OK"!=t[0]?printVerifInteg(e,t):alert("Enhorabuena! No se ha encontrado ningún error"))},50))}function costePersona(e){if(0!=bLoggedIn)if(aUsuRoles.indexOf("TODO")<0)alert("Opcion reservada para Dirección Financiera");else{var t=oGrid.getFirstSelectedRow();if(!(t<1)&&(gPCSiglas=oGrid.getCell(t,1),"string"==typeof e)){gPCFunction=e,gPCCambiado=!1,gPCMalSS=!1,oPCWin=new Form("Entrada de costes de "+gPCSiglas,360,300);var o=40;Label(oPCWin,o,20,"Ingresos anuales sujetos a SS"),oPCConSS=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCConSS.setNumericMask(9,2,",",".",!0,!1,""),oPCConSS.setWidth(100),o+=30,Label(oPCWin,o,20,"Ingresos anuales NO sujetos a SS"),oPCSinSS=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCSinSS.setNumericMask(9,2,",",".",!0,!1,""),oPCSinSS.setWidth(100),o+=30,Label(oPCWin,o,20,"Base máxima anual SS","red"),oPCBaseSS=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCBaseSS.setNumericMask(9,2,",",".",!0,!1,""),oPCBaseSS.setWidth(100),oPCBaseSS.setAsNumber(gTOPESS),o+=30,Label(oPCWin,o,20,"Porcentaje SS Empresa","red"),oPCPctSS=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCPctSS.setNumericMask(4,2,",",".",!0,!1,""),oPCPctSS.setWidth(60),oPCPctSS.setAsNumber(gPCTSS),o+=30,Label(oPCWin,o,20,"Número de horas reales al año","red"),oPCDias=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCDias.setNumericMask(4,0,",",".",!0,!1,""),oPCDias.setWidth(60),oPCDias.setAsNumber(gHORASLEC),o+=60,Label(oPCWin,o,20,"Coste H/H empresa"),oPCCoste=new TextBox(oPCWin,o,240,"",!1,"oPCWinChange(this)"),oPCCoste.setNumericMask(4,2,",",".",!0,!1,""),oPCCoste.setWidth(60),o+=40,oPCGuardar=new Button(oPCWin,o,20,"Guardar","oPCWinGuardar()",100),oPCCalcular=new Button(oPCWin,o,130,"Calcular","oPCWinCalcular()",100),oPCSalir=new Button(oPCWin,o,240,"Salir","oPCWinSalir()",100),oPCGuardar.disable(),oPCCalcular.disable(),oPCGetData(),oPCWin.fadeIn()}}else alert("No has hecho login")}function oPCWinSalir(){gPCCambiado&&!confirm("Los cambios realizados se perderán.\n¿Estás seguro de salir?")||oPCWin.release()}function oPCWinChange(e){gPCCambiado=!0,oPCGuardar.enable()}function oPCGetData(){var e=httpRequest(sRequestAdmper,"GETCOSTPER",sUsuario,gPCSiglas);if(!esUnError(e)){var t,o=e[0];if("S"==o[5])disableAll(oPCWin),oPCSalir.enable(),oPCCoste.enable(),oPCConSS.setValue("0"),oPCSinSS.setValue("0"),oPCCoste.setAsNumber(parseFloat(o[4])),oPCCoste.setFocus();else oPCCalcular.enable(),oPCCoste.disable(),oPCConSS.setAsNumber(parseFloat(o[0])),oPCSinSS.setAsNumber(parseFloat(o[1])),0<(t=parseFloat(o[2]))&&(t!=gTOPESS&&(oPCBaseSS.setColor("","yellow"),gPCMalSS=!0),oPCBaseSS.setAsNumber(t)),0<(t=parseFloat(o[3]))&&(t!=gPCTSS&&(oPCPctSS.setColor("","yellow"),gPCMalSS=!0),oPCPctSS.setAsNumber(t)),oPCCoste.setAsNumber(parseFloat(o[4])),oPCConSS.setFocus()}}function oPCWinCalcular(){var e,t,o;gPCMalSS&&confirm("Los parámetros de cálculo de SS de esta persona son diferentes a los estándar.\n¿Quieres forzar los valores estándar?")&&(oPCBaseSS.setAsNumber(gTOPESS),oPCPctSS.setAsNumber(gPCTSS),gPCCambiado=!0),oPCBaseSS.setColor("",""),oPCPctSS.setColor("",""),gPCMalSS=!1,o=(e=oPCConSS.getAsNumber())+oPCSinSS.getAsNumber()+((t=oPCBaseSS.getAsNumber())<e?t:e)*oPCPctSS.getAsNumber()/100,oPCCoste.setAsNumber(o/oPCDias.getAsNumber()),oPCGuardar.enable(),oPCCambiado=!0}function oPCWinGuardar(){if(0!=oPCCoste.getAsNumber()){var e=[gPCSiglas,oPCConSS.getAsNumber().toString(),oPCSinSS.getAsNumber().toString(),oPCBaseSS.getAsNumber().toString(),oPCPctSS.getAsNumber().toString(),oPCCoste.getAsNumber().toString()],t=httpRequest(sRequestAdmper,"SETCOSTPER",sUsuario,e);if(!esUnError(t))new Function(gPCFunction+"()")(),oPCWin.release()}else alert("El coste hora no puede ser cero")}function detDoc(e){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("REGDOC")<0)alert("Opción reservada para roles ADMON y REGDOC");else{gDDAccion=e,oDetWin=new Form("Documento",500,340);var t=40;Label(oDetWin,t,15,"Proyecto*"),oDetProy=new TextBox(oDetWin,t,80,"",!1,"proyectoOnChange(this)","proy"),oDetProy.setWidth(40),oDetProyHelp=new Button(oDetWin,t,130,"?","ayudaProy(this)",20,22),oDetProyHelp.setTooltip("Buscar proyecto"),document.getElementById(oDetProyHelp.getId()).tabIndex=-1,oDetProyDesc=new Label(oDetWin,t,160,"","","","proyDesc"),t+=30,Label(oDetWin,t,15,"Tipo*"),oDetTipo=new TextBox(oDetWin,t,80,"",!1,"ayudaSimpleOnChange(this, true)"),oDetTipo.setWidth(40),oDetTipoHelp=new Button(oDetWin,t,130,"?","ayudaSimple(this)",20,22),oDetTipoHelp.setTooltip("Buscar tipo de documento"),oDetTipoDesc=new Label(oDetWin,t,160,"","",""),prepararAyudaSimple(oDetTipo,oDetTipoHelp,oDetTipoDesc,"Tipos:Tipo:Descrip"),t+=30,Label(oDetWin,t,15,"Doc nº"),oDetNum=new TextBox(oDetWin,t,80,"",!1,""),oDetNum.setWidth(100),oDetNum.disable(),t+=30,Label(oDetWin,t,15,"Trabajo"),oDetTrab=new TextBox(oDetWin,t,80,"",!1,"trabajoOnChange(this, true)","trab"),oDetTrab.setWidth(40),oDetTrabHelp=new Button(oDetWin,t,130,"?","ayudaTrab(this)",20,22),oDetTrabHelp.setTooltip("Buscar trabajo del proyecto seleccionado"),document.getElementById(oDetTrabHelp.getId()).tabIndex=-1,oDetTrabDesc=new Label(oDetWin,t,160,"","","","trabDesc"),t+=30,Label(oDetWin,t,15,"Autor*"),oDetAutor=new TextBox(oDetWin,t,80,"",!1,"ayudaSimpleOnChange(this, true)"),oDetAutor.setWidth(40),oDetAutorHelp=new Button(oDetWin,t,130,"?","ayudaSimple(this)",20,22),oDetAutorHelp.setTooltip("Autor del documento"),oDetAutorDesc=new Label(oDetWin,t,160,"","",""),prepararAyudaSimple(oDetAutor,oDetAutorHelp,oDetAutorDesc,"Recursos:Siglas:Nombre"),t+=30,Label(oDetWin,t,15,"Fecha*"),oDetFecha=new DatePicker(oDetWin,t,80,"",""),t+=30,Label(oDetWin,t,15,"Título*"),oDetTitulo=new TextBox(oDetWin,t,80,"",!1,""),oDetTitulo.setWidth(320),t+=30,Label(oDetWin,t,15,"Archivo*"),oDetArchivo=new TextBox(oDetWin,t,80,"",!1,""),oDetArchivo.setWidth(400),t+=50,oDetGuardar=new Button(oDetWin,t,50,"Guardar","detDocGuardarClick()"),oDetGenerar=new Button(oDetWin,t,180,"Generar","detDocGenerarClick()"),oDetSalir=new Button(oDetWin,t,310,"Salir","detDocSalirClick()"),disableAll(oDetWin),oDetSalir.enable(),detDocOnLoad(e),oDetWin.fadeIn()}else alert("No has hecho login")}function detDocSalirClick(){oDetWin.release()}function detDocOnLoad(e){switch(e){case"A":oDetProy.enable(),oDetProyHelp.enable(),oDetTipo.enable(),oDetTipoHelp.enable(),oDetGenerar.enable(),oDetProy.setFocus();break;case"V":case"U":detDocGet(e)}}function detDocGenerarClick(){var e=oDetProy.getValue(),t=oDetTipo.getValue();if(3==e.length&&2==t.length){var o=httpRequest(sRequestAdmdoc,"DOCNEXT",sUsuario,e,t);if(!esUnError(o)){var a=lpad(o,"3","0");oDetNum.setValue(e+t+a+"R01"),oDetGenerar.disable(),oDetGuardar.enable(),oDetProy.disable(),oDetProyHelp.disable(),oDetTipo.disable(),oDetTipoHelp.disable(),oDetTrab.enable(),oDetTrabHelp.enable(),oDetAutor.enable(),oDetAutorHelp.enable(),oDetFecha.enable(),oDetFecha.setValue(date2js(new Date)),oDetTitulo.enable(),oDetArchivo.enable(),oDetTrab.setFocus()}}else alert("Debes indicar un proyecto y tipo correctos")}function detDocGet(e){var t=oLstGrid.getFirstSelectedRow();if(!(t<1)){var o=oLstGrid.getCell(t,1);oDetProy.setValue(o),oDetProy.change();var a=oLstGrid.getCell(t,2);oDetTipo.setValue(a),oDetTipo.change();var i=lpad(oLstGrid.getCell(t,3),"3","0"),r=parseInt(oLstGrid.getCell(t,4));"V"==e&&r++;var n=lpad(r,"2","0");oDetNum.setValue(o+a+i+"R"+n),oDetTrab.setValue(oLstGrid.getCell(t,5)),oDetTrab.change(),oDetAutor.setValue(oLstGrid.getCell(t,6)),oDetAutor.change(),oDetFecha.setValue(fecha2js(oLstGrid.getCell(t,7))),oDetTitulo.setValue(oLstGrid.getCell(t,8)),oDetArchivo.setValue(oLstGrid.getCell(t,9)),oDetGuardar.enable(),oDetTrab.enable(),oDetTrabHelp.enable(),oDetAutor.enable(),oDetAutorHelp.enable(),oDetFecha.enable(),oDetTitulo.enable(),oDetArchivo.enable(),oDetTrab.setFocus()}}function detDocGuardarClick(){if(""==trim(oDetAutor.getValue()))return alert("El campo Autor es obligatorio"),void oDetAutor.setFocus();if(""==oDetFecha.getValue())return alert("El campo Fecha es obligatorio"),void oDetFecha.setFocus();if(""==trim(oDetTitulo.getValue()))return alert("El campo Titulo es obligatorio"),void oDetTitulo.setFocus();if(""==trim(oDetArchivo.getValue()))return alert("El campo Archivo es obligatorio"),void oDetArchivo.setFocus();var e=oDetNum.getValue(),t=e.substr(5,3),o=e.substr(9,2),a=[oDetProy.getValue(),oDetTipo.getValue(),t,o,"*",oDetTrab.getValue(),oDetAutor.getValue(),oDetFecha.getValue(),oDetTitulo.getValue().trim().substr(0,50),oDetArchivo.getValue().trim().substr(0,128).replaceAll("\\","/")],i=httpRequest(sRequestAdmdoc,"UPDDOC",sUsuario,gDDAccion,a);esUnError(i)||(alert("Acción ejecutada con éxito"),listDocBuscar(!1),oDetWin.release())}function detFacEmi(e,t,o,a,i,r,n){if(0!=bLoggedIn){gDetFacEmiAccion=e,gDetFacEmiRefresh=t,gDetFacEmiCambiado=!1;var s,l=aUsuRoles.indexOf("ADMON")<0,d="Administración";switch(e){case"A":s="Nueva Factura";break;case"P":if(!(o&&a&&r&&n))return;s="Nueva Factura";break;case"V":if(!o||!a||!i)return;s="Ver factura",l=aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0,d="roles ADMON y VIEW";break;case"C":if(!o||!a||!i)return;s="Cobrar factura";break;case"U":if(!o||!a||!i)return;if(s="Editar factura",!l&&!confirm("¡¡ATENCION!! Editar una factura definitiva es un proceso muy delicado. ¿Estás seguro de editarla?"))return;break;default:return}if(l)alert("Opcion reservada para "+d);else{oDetWin=new Form(s,500,550),Label(oDetWin,40,15,"Proyecto"),oDetProy=new TextBox(oDetWin,40,80,"",!1,"proyectoOnChange(this)","proy"),oDetProy.setWidth(50),oDetProyHelp=new Button(oDetWin,40,140,"?","ayudaProy(this)",20,22),oDetProyHelp.setTooltip("Buscar proyecto"),document.getElementById(oDetProyHelp.getId()).tabIndex=-1,oDetProyDesc=new Label(oDetWin,40,170,"","","","proyDesc"),Label(oDetWin,70,15,"Trabajo"),oDetTrab=new TextBox(oDetWin,70,80,"",!1,"trabajoOnChange(this, true)","trab"),oDetTrab.setWidth(50),oDetTrabHelp=new Button(oDetWin,70,140,"?","ayudaTrab(this)",20,22),oDetTrabHelp.setTooltip("Buscar trabajo del proyecto seleccionado"),document.getElementById(oDetTrabHelp.getId()).tabIndex=-1,oDetTrabDesc=new Label(oDetWin,70,170,"","","","trabDesc"),Label(oDetWin,100,15,"Numero"),oDetNum=new TextBox(oDetWin,100,80,""),oDetNum.setWidth(50),oDetNum.disable(),Label(oDetWin,100,250,"Estado"),oDetEstad=new ComboBox(oDetWin,100,315,["Borrador","Emitida","Cobrada","Cob. Parc","Anulada"],["B","E","C","P","A"],0),oDetEstad.disable();var c=new Date;Label(oDetWin,130,15,"Emitida"),oDetFemi=new DatePicker(oDetWin,130,80,date2js(c),"detFacEmiFemiOnChange()"),Label(oDetWin,130,250,"Vence"),c.setDate(c.getDate()+30),oDetFvto=new DatePicker(oDetWin,130,315,date2js(c),"detFacEmiFvtoOnChange()"),Label(oDetWin,160,15,"% IVA"),oDetIva=new TextBox(oDetWin,160,80,gPCTIVA.toString(),!1,"detFacEmiIvaOnChange()"),oDetIva.setAlign("rigth"),oDetIva.setWidth(30),Label(oDetWin,160,130,"Neto"),oDetNeto=new TextBox(oDetWin,160,180,""),oDetNeto.setNumericMask(9,2,",",".",!0,!1,""),oDetNeto.setWidth(100),Label(oDetWin,160,310,"Total"),oDetTotal=new TextBox(oDetWin,160,360,""),oDetTotal.setNumericMask(9,2,",",".",!0,!1,""),oDetTotal.setWidth(100),Label(oDetWin,190,15,"Cobrada"),oDetFcbr=new DatePicker(oDetWin,190,80,""),Label(oDetWin,190,270,"Total cobrado"),oDetCobrado=new TextBox(oDetWin,190,360,""),oDetCobrado.setWidth(100),oDetCobrado.setNumericMask(9,2,",",".",!0,!1,""),Label(oDetWin,220,15,"Corresponde a trabajos realizados en el mes"),oDetMes=new ComboBox(oDetWin,220,290,["----","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["0","1","2","3","4","5","6","7","8","9","10","11","12"],0),Label(oDetWin,220,385,"de"),oDetAnno=new ComboBox(oDetWin,220,407,["2017","2018","2019","2020","2021","2022"],["2017","2018","2019","2020","2021","2022"],0),ponAnnoActual(oDetAnno),oDetGrid=new Grid(oDetWin,260,5,490,170,["Item","Descripcion","Importe"],470,!1,"detFacEmiGridClick()"),oDetBuscar=new Button(oDetWin,445,70,"Buscar","detFacEmiBuscarClick()",80),oDetAgregar=new Button(oDetWin,445,160,"Agregar","lineaFacEmi(true)",80),oDetEditar=new Button(oDetWin,445,250,"Editar","lineaFacEmi(false)",80),oDetSuprimir=new Button(oDetWin,445,340,"Suprimir","detFacEmiSuprimirClick()",80),oDetPanel=new Panel(oDetWin,490,5,485,45,""),oDetGuardar=new Button(oDetWin,500,50,"Guardar","detFacEmiGuardarClick()"),oDetImprimir=new Button(oDetWin,500,180,"Imprimir","printFacEmiPDF(false)"),oDetSalir=new Button(oDetWin,500,310,"Salir","detFacEmiSalirClick()"),disableAll(oDetWin),oDetSalir.enable(),detFacEmiOnLoad(e,o,a,i,r,n)&&oDetWin.fadeIn()}}else alert("No has hecho login")}function detFacEmiGridClick(){detFacEmiRecalcular()}function detFacEmiOnLoad(e,t,o,a,i,r){switch(e){case"A":oDetProy.enable(),oDetProyHelp.enable(),t&&(oDetProy.setValue(t),proyectoOnChange(oDetProy.getElement())),oDetTrab.enable(),oDetTrabHelp.enable(),o&&(oDetTrab.setValue(o),trabajoOnChange(oDetTrab.getElement(),!0)),oDetAnno.enable(),oDetMes.enable(),oDetBuscar.enable(),oDetProy.setFocus(),gDetFacEmiCambiado=!1;break;case"P":if(!(t&&o&&i&&r))return alert("Parámetros incompletos"),!1;oDetProy.setValue(t),proyectoOnChange(oDetProy.getElement()),oDetTrab.setValue(o),trabajoOnChange(oDetTrab.getElement(),!0),oDetMes.setIndexByValue(r),oDetAnno.setIndexByValue(i),detFacEmiBuscarClick(),gDetFacEmiAccion="A";break;case"C":if(!t||!o||!a)return alert("Parámetros incompletos"),!1;oDetFcbr.enable(),oDetCobrado.enable(),oDetGuardar.enable(),oDetImprimir.enable(),detFacEmiGetFactura(t,o,a)||oDetWin.release(),""==oDetFcbr.getValue()?(oDetFcbr.setValue(date2js(new Date)),oDetCobrado.setValue(oDetTotal.getValue()),gDetFacEmiCambiado=!0):gDetFacEmiCambiado=!1,oDetFcbr.setFocus();break;case"V":if(!t||!o||!a)return alert("Parámetros incompletos"),!1;oDetImprimir.enable(),detFacEmiGetFactura(t,o,a)||oDetWin.release();break;case"U":if(!t||!o||!a)return alert("Parámetros incompletos"),!1;oDetGuardar.enable(),oDetImprimir.enable(),gLFETieneTodo&&(oDetFemi.enable(),oDetFvto.enable(),oDetMes.enable(),oDetAnno.enable()),detFacEmiGetFactura(t,o,a)||oDetWin.release(),gLFETieneTodo||0==strToNumberSpain(oDetCobrado.getValue())||(alert("No se puede editar una factura cobrada total o parcialmente"),oDetWin.release())}}function detFacEmiBuscarClick(){return 3!=oDetProy.getValue().length?(alert("Proyecto es obligatorio"),void oDetProy.setFocus()):3!=oDetTrab.getValue().length?(alert("Trabajo es obligatorio"),void oDetTrab.setFocus()):0==oDetMes.getSelectedIndex()?(alert("Mes es obligatorio"),void oDetMes.setFocus()):void(detFacEmiNext()&&detFacEmiGetFactura(oDetProy.getValue(),oDetTrab.getValue()," ")&&(oDetProy.disable(),oDetProyHelp.disable(),oDetTrab.disable(),oDetTrabHelp.disable(),oDetAnno.disable(),oDetMes.disable(),oDetBuscar.disable(),oDetFemi.enable(),oDetFvto.enable(),oDetIva.enable(),oDetAgregar.enable(),oDetGuardar.enable(),oDetFemi.setFocus(),gDetFacEmiCambiado=!1))}function detFacEmiNext(){var e=httpRequest(sRequestFacemi,"FACEMINEXT",sUsuario,oDetProy.getValue(),oDetTrab.getValue());return esUnError(e)?(oDetNum.setValue(""),!1):(oDetNum.setValue(e.toString()),!0)}function detFacEmiGetFactura(e,t,o){var a=oDetAnno.getSelectedValue(),i=oDetMes.getSelectedValue(),r=httpRequest(sRequestFacemi,"GETFACEMI",sUsuario,e,t,o,a,i);if(esUnError(r))return!1;if(3==o.length){var n=r[0];oDetProy.setValue(n[0]),document.getElementById(oDetProy.getId()).onchange(),oDetTrab.setValue(n[1]),document.getElementById(oDetTrab.getId()).onchange(),oDetNum.setValue(n[2]),oDetAnno.setIndexByValue(n[3]),oDetMes.setIndexByValue(n[4]);var s=parseFloat(n[5]);oDetNeto.setValue(numberToStrSpain(s,2,!0));var l=parseFloat(n[6]);oDetIva.setValue(parseInt(l/s*100));var d=parseFloat(n[7]);oDetTotal.setValue(numberToStrSpain(d,2,!0)),oDetFemi.setValue(n[8]),oDetFvto.setValue(n[9]),"    -  -  "==n[10]&&(n[10]=""),oDetFcbr.setValue(n[10]),oDetEstad.setIndexByValue(n[11]);var c=parseFloat(n[12]);oDetCobrado.setValue(numberToStrSpain(c,2,!0))}for(var u,m,g=[],b=0,D="";1<oDetGrid.getRowCount();)oDetGrid.deleteRow(1);for(var p=1;p<r.length;p++){var f=r[p];if(f.length<11)return void alert("Respuesta errónea del servidor. Alguna línea es incorrecta");D+=f[7]+"<br>",0!=(u=parseFloat(f[8]))&&(m=parseFloat(f[9]),b++,g.push([b.toString(),D,numberToStrSpain(u,2,!0)]),D="")}0<g.length&&oDetIva.setValue(m.toString());for(var C="C"==gDetFacEmiAccion||"V"==gDetFacEmiAccion,A=0;A<g.length;A++)oDetGrid.addRow(g[A],C),oDetGrid.setCellAlign(A+1,3,"right","bottom");return gDetFacEmiCambiado=!1,detFacEmiRecalcular(),!0}function detFacEmiRecalcular(){for(var e,t=0,o=0,a=parseFloat(oDetIva.getValue()),i=oDetGrid.getRowCount(),r=1;r<i;r++)oDetGrid.setCell(r,1,r.toString()),"A"==gDetFacEmiAccion&&oDetGrid.isSelected(r)&&(t+=e=strToNumberSpain(oDetGrid.getCell(r,3)),o+=e+e*a/100);"A"==gDetFacEmiAccion&&(0==t?(oDetNeto.setValue(""),oDetTotal.setValue(""),oDetImprimir.disable(),oDetGuardar.setValue("Guardar"),oDetGuardar.setColor("","")):(oDetNeto.setValue(numberToStrSpain(t,2,!0)),oDetTotal.setValue(numberToStrSpain(o,2,!0)),oDetGuardar.enable(),oDetGuardar.setValue("Emitir"),oDetGuardar.setColor("black","yellow"),oDetImprimir.enable())),"A"!=gDetFacEmiAccion&&"U"!=gDetFacEmiAccion||(oDetAgregar.enable(),1==oDetGrid.getSelectedRowCount()?(oDetEditar.enable(),oDetSuprimir.enable()):(oDetEditar.disable(),oDetSuprimir.disable()))}function detFacEmiSuprimirClick(){nrow=oDetGrid.getFirstSelectedRow(),nrow<1||confirm("¿Estás seguro de eliminar esta linea de factura?")&&(oDetGrid.deleteRow(nrow),gDetFacEmiCambiado=!0,detFacEmiRecalcular())}function detFacEmiGuardarClick(){var e,t,o=!1,a=oDetEstad.getSelectedValue(),i=oDetNum.getValue(),r=strToNumberSpain(oDetNeto.getValue()),n=oDetIva.getValue(),s=r*parseFloat(n)/100;switch(gDetFacEmiAccion){case"A":if(0<oDetGrid.getSelectedRowCount()){if(!(o=confirm("¿Guardar lineas seleccionadas como factura definitiva?")))return;a="E"}else{if(!confirm("¿Actualizar las lineas pendientes de facturar?"))return;i=a=" "}break;case"C":var l,d=strToNumberSpain(oDetCobrado.getValue()),c=strToNumberSpain(oDetTotal.getValue());if(""==(l=bInternetExplorer?fecha2js(oDetFcbr.getValue()):oDetFcbr.getValue())||0==d)return void alert("Debes rellenar todos los campos");if(Math.abs(d)>Math.abs(c))return void alert("La cantidad cobrada no puede ser mayor que el total factura");a=d.toFixed(2)==c.toFixed(2)?"C":"P";break;case"U":if(!detFacEmiCheckImporte())return void alert("El importe de las líneas no coincide con el total");break;default:return void alert("No es posible guardar con esta accion")}e=oDetFemi.getValue(),t=oDetFvto.getValue(),l=oDetFcbr.getValue();var u=[gDetFacEmiAccion,oDetProy.getValue(),oDetTrab.getValue(),i,oDetAnno.getSelectedValue(),oDetMes.getSelectedValue(),r.toString(),s.toString(),(r+s).toString(),e,t,l,strToNumberSpain(oDetCobrado.getValue()).toString(),a],m=[];if("A"==gDetFacEmiAccion||"U"==gDetFacEmiAccion)for(var g=oDetGrid.getRowCount(),b=oDetProy.getValue()+oDetTrab.getValue()+oDetNum.getValue(),D=1;D<g;D++){var p;if(!((p=oDetGrid.getCell(D,2).replaceAll("&amp;","&").replaceAll('"',"").split("<br>")).length<1)){for(;p[p.length-1].trim().length<1;)p.pop();var f=strToNumberSpain(oDetGrid.getCell(D,3)).toString(),C=" ";for((o&&oDetGrid.isSelected(D)||"U"==gDetFacEmiAccion)&&(C=b),j=0;j<p.length;j++)m.push([C,p[j].trim(),j==p.length-1?f:"0",n])}}var A=httpRequest(sRequestFacemi,"UPDFACEMI",sUsuario,u,m);esUnError(A)||(alert("Factura guardada con éxito"),setTimeout(function(){"A"==gDetFacEmiAccion?(detFacEmiGetFactura(oDetProy.getValue(),oDetTrab.getValue()," "),gDetFacEmiCambiado=!1,o&&(detFacEmiCallRefresh(),detFacEmiNext())):(detFacEmiCallRefresh(),oDetWin.release())},200),"A"==gDetFacEmiAccion&&o&&printFacEmiPDF(!0))}function detFacEmiCallRefresh(){gDetFacEmiRefresh&&new Function(gDetFacEmiRefresh+"(true)")(!0)}function detFacEmiIvaOnChange(){if(!(oDetNeto.getValue().length<1)){var e=strToNumberSpain(oDetNeto.getValue())*(1+parseFloat(oDetIva.getValue())/100);oDetTotal.setValue(numberToStrSpain(e,2,!0)),gDetFacEmiCambiado=!0}}function detFacEmiFemiOnChange(){var e;bInternetExplorer?((e=new Date(fecha2js(oDetFemi.getValue()))).setDate(e.getDate()+30),oDetFvto.setValue(date2std(e))):((e=new Date(oDetFemi.getValue())).setDate(e.getDate()+30),oDetFvto.setValue(date2js(e))),gDetFacEmiCambiado=!0}function detFacEmiFvtoOnChange(){gDetFacEmiCambiado=!0}function detFacEmiSalirClick(){if(gDetFacEmiCambiado){if(!confirm("Los cambios realizados se perderán. ¿Estás seguro de salir?"))return;detFacEmiCallRefresh()}oDetWin.release()}function detFacEmiCheckImporte(){for(var e=0,t=oDetGrid.getRowCount(),o=1;o<t;o++)e+=strToNumberSpain(oDetGrid.getCell(o,3));return e.toFixed(2)==strToNumberSpain(oDetNeto.getValue()).toFixed(2)}function detFacRec(e,t,o){if(0!=bLoggedIn){var a=aUsuRoles.indexOf("ADMON")<0;if("V"==e&&(a=aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0),a)alert("Opción reservada para Administración");else{if(cDFRaccion=e,t&&o?(gDetMasterGrid=t,gDetMasterKeys=o):(gDetMasterGrid=oLstGrid,gDetMasterKeys=[1,2]),cDFRProve="",cDFRNumero="","A"==e)ckIsEmpty(oLstProv.getValue())||(cDFRProve=oLstProv.getValue());else{var i=gDetMasterGrid.getFirstSelectedRow();if(i<1)return;cDFRProve=gDetMasterGrid.getCell(i,gDetMasterKeys[0]),cDFRNumero=gDetMasterGrid.getCell(i,gDetMasterKeys[1])}var r=50,n=100;switch(oDWin=new Form("Detalle Factura Recibida",550,400),Label(oDWin,r,20,"Proveedor*"),oDProv=new TextBox(oDWin,r,n,cDFRProve,!1,"detFacRecHelp()"),oDProv.setTooltip("Entra primeras letras y pulsa <tabulador>"),oDProv.setWidth(150),r+=30,Label(oDWin,r,20,"Número*"),oDNum=new TextBox(oDWin,r,n,cDFRNumero,!1),Label(oDWin,r,280,"No. previo"),oDNumPrev=new TextBox(oDWin,r,370,"",!1),r+=30,Label(oDWin,r,20,"Concepto*"),oDConcepto=new TextBox(oDWin,r,n,"",!1),oDConcepto.setWidth(430),r+=30,Label(oDWin,r,20,"Importe tot*"),oDImpTot=new TextBox(oDWin,r,n,"",!1),oDImpTot.setWidth(100),oDImpTot.setNumericMask(8,2,",",".",!0,!1,""),Label(oDWin,r,280,"Importe neto*"),oDImpNeto=new TextBox(oDWin,r,370,"",!1),oDImpNeto.setWidth(100),oDImpNeto.setNumericMask(8,2,",",".",!0,!1,""),r+=30,Label(oDWin,r,20,"Fecha Emi.*"),oDFecEmi=new DatePicker(oDWin,r,n,""),Label(oDWin,r,280,"Fecha Vto.*"),oDFecVto=new DatePicker(oDWin,r,370,""),r+=30,Label(oDWin,r,20,"Notas"),oDNotas=new TextBox(oDWin,r,n,"",!1),oDNotas.setWidth(430),r+=30,Label(oDWin,r,20,"Frm. pago*"),oDFormPago=new ComboBox(oDWin,r,n,["---","Domiciliada","Visa","PayPal","Transferencia","Caja"],["","D","V","P","T","C"],0),Label(oDWin,r,280,"Tipo Gasto*"),oDTipoG=new ComboBox(oDWin,r,370,["---","Inmovilizado","G. Generales","G. Reembolsables","Subcontrata","Otros"],["","I","G","R","S","O"],0),r+=30,Label(oDWin,r,20,"Estado*"),oDEstado=new ComboBox(oDWin,r,n,["Recibida","Pagada","No conforme"],["R","P","N"],0),Label(oDWin,r,280,"Fecha Pago"),oDFecPag=new DatePicker(oDWin,r,370,""),r+=30,Label(oDWin,r,20,"Banco"),oDBanco=new TextBox(oDWin,r,n,"",!1),oDBanco.setWidth(char2pixel(20)),r+=50,oDSave=new Button(oDWin,r,130,"Guardar","detFacRecSave()"),oDSalir=new Button(oDWin,r,280,"Salir","oDWin.release()"),disableAll(oDWin),oDSalir.enable(),e){case"V":detFacRecVerPrep();break;case"A":detFacRecAltaPrep();break;case"E":detFacRecEditPrep();break;case"P":detFacRecPayPrep();break;case"D":detFacRecDefPrep()}oDWin.fadeIn()}}else alert("No has hecho login")}function detFacRecSave(){switch(cDFRaccion){case"A":detFacRecAltaSave();break;case"E":detFacRecEditSave();break;case"P":detFacRecPaySave();break;case"D":detFacRecDefSave()}}function detFacRecVerPrep(){detFacRec2Fields()||oDWin.release()}function detFacRecAltaPrep(){enableAll(oDWin),oDNumPrev.disable(),oDEstado.disable(),oDFecPag.disable(),oDProv.setFocus()}function detFacRecAltaSave(){for(var e=detFacRec2Array(),t=0;t<9;t++)if(ckIsEmpty(e[t]))return void alert("Todos los campos marcados con * son obligatorios");var o=httpRequest(sRequestFacrec,"UPDFACREC",sUsuario,"A",e);esUnError(o)||(alert("Factura guardada con éxito"),oDWin.release(),ckIsEmpty(oLstProv.getValue())&&ckIsEmpty(oLstEstad.getSelectedValue())||listFacRecGet())}function detFacRecEditPrep(){detFacRec2Fields()?("P"!=oDEstado.getSelectedValue()&&(oDImpTot.enable(),oDImpNeto.enable(),oDFecEmi.enable(),oDFecVto.enable(),oDFormPago.enable(),oDTipoG.enable(),oDBanco.enable()),oDNotas.enable(),oDConcepto.enable(),oDSave.enable()):oDWin.release()}function detFacRecEditSave(){var e=detFacRec2Array();if("P"!=oDEstado.getSelectedValue()){for(var t=0;t<9;t++)if(ckIsEmpty(e[t]))return void alert("Todos los campos marcados con * son obligatorios")}else if(ckIsEmpty(oDConcepto.getValue()))return void alert("El campo 'Concepto' es obligatorio");detFacRecUpdate(e)}function detFacRecPayPrep(){if(detFacRec2Fields()){if("P"==oDEstado.getSelectedValue())return alert("Esa factura ya está pagada"),void oDWin.release();oDEstado.setIndexByValue("P"),oDFormPago.enable(),oDTipoG.enable(),oDFecPag.enable(),oDFecPag.setValue(date2js(new Date)),oDBanco.enable(),oDNotas.enable(),oDSave.enable()}else oDWin.release()}function detFacRecPaySave(){for(var e=detFacRec2Array(),t=0;t<13;t++)if(10!=t&&ckIsEmpty(e[t]))return void alert("Debe rellenar todos los campos");detFacRecUpdate(e)}function detFacRecDefPrep(){if(detFacRec2Fields()){if(!ckIsEmpty(oDNumPrev.getValue()))return alert("Esa factura ya se ha dado como definitiva"),void oDWin.release();oDNumPrev.setValue(oDNum.getValue()),oDNum.setValue(""),oDNum.enable(),oDConcepto.enable(),oDNotas.enable(),oDSave.enable(),oDNum.setFocus()}else oDWin.release()}function detFacRecDefSave(){var e=detFacRec2Array();if(ckIsEmpty(e[1]))alert("Debe rellenar el numero definitivo");else{var t=e[10],o=e[1];e[1]=t;var a=httpRequest(sRequestFacrec,"DELFACREC",sUsuario,e);esUnError(a)||(e[1]=o,e[10]=t,a=httpRequest(sRequestFacrec,"UPDFACREC",sUsuario,"A",e),esUnError(a)||(alert("Factura guardada con éxito"),oDWin.release(),listFacRecGet()))}}function detFacRecUpdate(e){var t=httpRequest(sRequestFacrec,"UPDFACREC",sUsuario,"E",e);esUnError(t)||(alert("Factura guardada con éxito"),oDWin.release(),listFacRecGet())}function detFacRec2Array(){var e=[];return e[0]=oDProv.getValue(),e[1]=oDNum.getValue(),e[2]=oDConcepto.getValue(),e[3]=oDImpTot.getAsNumber(),e[4]=oDImpNeto.getAsNumber(),e[5]=oDFecEmi.getValue(!0),e[6]=oDFecVto.getValue(!0),e[7]=oDFormPago.getSelectedValue(),e[8]=oDTipoG.getSelectedValue(),e[9]=oDEstado.getSelectedValue(),e[10]=oDNumPrev.getValue(),e[11]=oDFecPag.getValue(!0),e[12]=oDBanco.getValue(),e[13]=oDNotas.getValue(),e}function detFacRec2Fields(){var e=httpRequest(sRequestFacrec,"GETFACREC",sUsuario,cDFRProve,cDFRNumero);if(esUnError(e))return!1;var t=e[0];return oDProv.setValue(t[0]),oDNum.setValue(t[1]),oDConcepto.setValue(trim(t[2])),oDImpTot.setAsNumber(parseFloat(t[3])),oDImpNeto.setAsNumber(parseFloat(t[4])),oDFecEmi.setValue(t[5]),oDFecVto.setValue(t[6]),oDFormPago.setIndexByValue(t[7]),oDTipoG.setIndexByValue(t[8]),oDEstado.setIndexByValue(t[9]),oDNumPrev.setValue(t[10]),oDFecPag.setValue(t[11]),oDBanco.setValue(t[12]),oDNotas.setValue(trim(t[13])),!0}function detFacRecHelp(){var e=trim(oDProv.getValue()).toUpperCase();oDProv.setValue(e);var t=httpRequest(sRequest,"HLPPROVE",sUsuario,e);if(esUnError(t))return oDProv.setValue(""),void oDProv.setFocus();var o=t.length;if(""==t[0]&&(o=0),0==o)return alert("No se han encontrado proveedores con esos datos"),oDProv.setValue(""),void oDProv.setFocus();if(1==o)return oDProv.setValue(trim(t[0][0])),void oDNum.setFocus();oWinPrv=new Form("Proveedores",565,270),oGridPrv=new Grid(oWinPrv,40,15,530,150,["Código","Nombre"],510),bSel=new Button(oWinPrv,210,160,"Seleccionar","gridDetPrvSelect()"),Button(oWinPrv,210,290,"Salir","oWinPrv.release()");for(var a=0;a<t.length;a++)oGridPrv.addRow(t[a]);oWinPrv.fadeIn()}function gridDetPrvSelect(){var e=oGridPrv.getFirstSelectedRow();e<1?oDProv.setFocus():(oDProv.setValue(trim(oGridPrv.getCell(e,1))),oWinPrv.release(),oDNum.setFocus())}function detNotGas(e){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0)alert("Opcion reservada para Administracion");else{cDNGAccion=e;var t=50,o=100;oDWin=new Form("Detalle Nota de Gastos",550,370),Label(oDWin,t,20,"Nota"),oDNum=new TextBox(oDWin,t,o,"",!1),oDNum.setWidth(50),oDNum.disable(),Label(oDWin,t,153,"/"),oDAnno=new TextBox(oDWin,t,165,"",!1),oDAnno.setWidth(50),oDAnno.disable(),t+=30,Label(oDWin,t,20,"Fecha"),oDFecha=new DatePicker(oDWin,t,o,"",""),t+=30,Label(oDWin,t,20,"Proyecto"),oDProy=new TextBox(oDWin,t,o,"",!1,"proyectoOnChange(this)","proy"),oDProy.setWidth(40),oDProyHelp=new Button(oDWin,t,150,"?","ayudaProy(this)",20,22),document.getElementById(oDProyHelp.getId()).tabIndex=-1,oDProyDesc=new Label(oDWin,t,180,"","","","proyDesc"),t+=30,Label(oDWin,t,20,"Trabajo"),oDTrab=new TextBox(oDWin,t,o,"",!1,"trabajoOnChange(this, true)","trab"),oDTrab.setWidth(40),oDTrabHelp=new Button(oDWin,t,150,"?","ayudaTrab(this)",20,22),document.getElementById(oDTrabHelp.getId()).tabIndex=-1,oDTrabDesc=new Label(oDWin,t,180,"","","","trabDesc"),t+=30,Label(oDWin,t,20,"Siglas"),oDSig=new TextBox(oDWin,t,o,"",!1,"ayudaSimpleOnChange(this, true)"),oDSig.setWidth(40),oDSigHelp=new Button(oDWin,t,150,"?","ayudaSimple(this)",20,22),document.getElementById(oDSigHelp.getId()).tabIndex=-1,oDSigDesc=new Label(oDWin,t,180,"","",""),prepararAyudaSimple(oDSig,oDSigHelp,oDSigDesc,"recursos:siglas:nombre"),t+=30,Label(oDWin,t,20,"Clase"),oDClase=new ComboBox(oDWin,t,o,["Subcontrata","Materiales","Reembolsables","Otros"],["S","M","G","O"],0),t+=30,Label(oDWin,t,20,"Motivo"),oDMotivo=new TextBox(oDWin,t,o,"",!1,"",""),oDMotivo.setWidth(32*nPixelPerChar),t+=30,Label(oDWin,t,20,"Importe"),oDImporte=new TextBox(oDWin,t,o,"",!1,"",""),oDImporte.setWidth(100),oDImporte.setNumericMask(8,2,",",".",!0,!1,""),t+=50,oDSave=new Button(oDWin,t,130,"Guardar","detNotGasSave()"),Button(oDWin,t,280,"Salir","oDWin.release()"),detNotGasGet(e),oDWin.fadeIn()}else alert("No has hecho login")}function detNotGasGet(e){switch(e){case"A":var t=httpRequest(sRequestAdmnotgas,"NOTGASNEXT",sUsuario);if(esUnError(t))return;oDNum.setValue(t[0]);var o=new Date;oDAnno.setValue(o.getFullYear().toString()),oDFecha.setValue(date2js(o));break;case"U":var a=oLstGrid.getFirstSelectedRow();if(a<1)return;t=httpRequest(sRequestAdmnotgas,"GETNOTGAS",sUsuario,oLstGrid.getCell(a,1));if(esUnError(t))return;var i=t[0];oDNum.setValue(i[0]),oDAnno.setValue(i[1]),oDFecha.setValue(i[2]),oDProy.setValue(i[3]),proyectoOnChange(document.getElementById(oDProy.getId())),oDTrab.setValue(i[4]),trabajoOnChange(document.getElementById(oDTrab.getId()),!0),oDSig.setValue(i[5]),ayudaSimpleOnChange(document.getElementById(oDSig.getId()),!0),oDClase.setIndexByValue(i[8]),oDMotivo.setValue(i[6]),oDImporte.setValue(numberToStrSpain(parseFloat(i[7]),2,!0));break;default:return}}function detNotGasSave(){if(ckIsEmpty(oDFecha.getValue())||ckIsEmpty(oDProy.getValue())||ckIsEmpty(oDTrab.getValue())||ckIsEmpty(oDSig.getValue())||ckIsEmpty(oDMotivo.getValue())||0==strToNumberSpain(oDImporte.getValue()))alert("Todos los campos son obligatorios");else{var e=[oDNum.getValue(),oDAnno.getValue(),oDFecha.getValue(),oDProy.getValue(),oDTrab.getValue(),oDSig.getValue(),oDMotivo.getValue(),strToNumberSpain(oDImporte.getValue()).toString(),oDClase.getSelectedValue()],t=httpRequest(sRequestAdmnotgas,"UPDNOTGAS",sUsuario,cDNGAccion,e);esUnError(t)||(alert("Nota de Gastos actualizada con éxito"),notGasBuscClick(!1),oDWin.release())}}function estadGeneral(){0!=bLoggedIn?aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0?alert("Opcion reservada para Administracion"):(oWin=new Form("Estadísticas mensuales",474,175),Label(oWin,60,60,"Año"),oAnno=new ComboBox(oWin,60,100,["----","2018","2019","2020","2021","2022"],["0","2018","2019","2020","2021","2022"],0),ponAnnoActual(oAnno),Label(oWin,60,170,"Mes"),oMes=new ComboBox(oWin,60,200,["----","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["0","1","2","3","4","5","6","7","8","9","10","11","12"],0),ponMesActual(oMes),Label(oWin,60,300,"Acumulado"),oAcum=new CheckBox(oWin,60,370),oAcum.check(),oBusc=new Button(oWin,115,105,"Buscar","estadGeneralGet()"),oExit=new Button(oWin,115,245,"Salir","oWin.release()"),oWin.fadeIn()):alert("No has hecho login !!!")}function estadGeneralGet(){var e,t,o=oAnno.getValue(oAnno.getSelectedIndex()),a=oMes.getValue(oMes.getSelectedIndex()),i=oAcum.getValue();"0"!=o&&"0"!=a?(e="S"==i?(t=!0,httpRequest(sRequestAdmper,"ESTADMES",sUsuario,o,a,"S")):(t=!1,httpRequest(sRequestAdmper,"ESTADMES",sUsuario,o,a,"N")),esUnError(e)||auxEstadPrint(o,a,t,e)):alert("Debes seleccionar año y mes")}function lineaFacEmi(e){gLineaFacAlta=e;var t=350;if(bInternetExplorer&&(t=365),oLineaWin=new Form("Item",t,320),oLineaTexto=new EditBox(oLineaWin,40,15,39,10,""),Label(oLineaWin,230,65,"Importe neto"),oLineaImporte=new TextBox(oLineaWin,230,150,""),oLineaImporte.setWidth(100),oLineaImporte.setNumericMask(8,2,",",".",!0,!1,""),oLineaGuardar=new Button(oLineaWin,270,40,"Guardar","oLineaGuardarClick()"),oLineaSalir=new Button(oLineaWin,270,180,"Salir","oLineaSalirClick()"),!e){var o=getSeleccion(oDetGrid),a=oDetGrid.getCell(o,2);a=a.replaceAll("<br>","\n").replaceAll("&amp;","&"),oLineaTexto.setValue(a),oLineaImporte.setValue(oDetGrid.getCell(o,3))}document.getElementById(oLineaTexto.getId()).focus(),oLineaWin.fadeIn()}function oLineaGuardarClick(){if(oLineaTexto.getValue().length<1||oLineaImporte.getValue().length<1)alert("Debes rellenar todos los campos");else{if(gLineaFacAlta){var e=[(t=oDetGrid.getRowCount()).toString(),wrapText(oLineaTexto.getValue(),40).join(""),oLineaImporte.getValue()];oDetGrid.addRow(e),oDetGrid.setCellAlign(t,3,"right","bottom")}else{var t=getSeleccion(oDetGrid);oDetGrid.setCell(t,2,wrapText(oLineaTexto.getValue(),40).join("")),oDetGrid.setCell(t,3,oLineaImporte.getValue())}detFacEmiRecalcular(),gDetFacEmiCambiado=!0,gLineaFacAlta=void 0,delete gLineaFacAlta,oLineaWin.release()}}function oLineaSalirClick(){gLineaFacAlta=void 0,delete gLineaFacAlta,oLineaWin.release()}function listadoGenerico(e,t,o,a,i){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0)alert("Opcion reservada para Administracion");else{gLGTitulo=t,gLGTabla=e,gLGFDetalle=void 0,gLFAKeys=void 0,a&&(gLGFDetalle=a),i&&(gLGAKeys=i),oLGWin=new Form(t,560,400),aLGObjetos=[],aLGListado=o;for(var r=0;r<aLGListado.length;r++){if((w=aLGListado[r])[0].indexOf(".")<0)w[0]=e+"."+w[0],w[8]="";else if("E"==w[6]&&0<w[7].length){if(0<w[7].indexOf("->")){var n=w[7].split("->");if(w[7]=n[0],n[1]){var s=parseInt(n[1]);!isNaN(s)&&0<=s&&s<r&&(aLGListado[s][20]=r)}}for(var l=w[0].split(".")[0],d=w[7].split(","),c="",u=0;u<d.length;u++)if(0<c.length&&(c+=" and "),0<=d[u].indexOf("("))c+=d[u];else{var m=d[u].split("=");m[1].indexOf(".")<0?c+=l+"."+m[1]+"=":c+=m[1]+"=",m[0].indexOf(".")<0?c+=e+"."+m[0]:c+=m[0]}w[8]=c}else w[8]=""}var g=40,b=120;Label(oLGWin,g,20,"Selección","red"),Label(oLGWin,g,425,"Ordenar","red"),Label(oLGWin,g,485,"Subtotal","red"),g+=30;for(r=0;r<o.length;r++)if(""!=o[r][1]&&"Q"!=o[6]){var D,p,f,C;switch(p=void 0,o[r][3]){case"C":switch(o[r][6]){case"C":if(o[r][7].length<1)break;for(var A=o[r][7].split(","),L=[],E=[],h=0;h<A.length;h++){var G=A[h].split("=");E.push(G[0]),L.push(G[1])}D=new ComboBox(oLGWin,g,b,L,E,0);break;case"M":(D=new TextBox(oLGWin,g,b,"")).setWidth(char2pixel(10*o[r][4])),document.getElementById(D.getId()).onchange=Function("forzarMayusculas(this)");break;case"U":(D=new TextBox(oLGWin,g,b,"")).setWidth(char2pixel(o[r][4])),document.getElementById(D.getId()).onchange=Function("forzarMayusculas(this)");break;case"A":D=new TextBox(oLGWin,g,b,"",!1,"ayudaSimpleOnChange(this, true)");var v=char2pixel(o[r][4]);D.setWidth(v);var F=o[r][7];0<F.length&&(oBj1A=new Button(oLGWin,g,b+v+10,"?","ayudaSimple(this)",20,22),F=reemplazarAyudasInternas(F),prepararAyudaSimple(D,oBj1A,null,F));break;case"R":(D=new TextBox(oLGWin,g,b,"")).setWidth(char2pixel(o[r][4])),(p=new TextBox(oLGWin,g,270,"")).setWidth(char2pixel(o[r][4]));break;default:(D=new TextBox(oLGWin,g,b,"")).setWidth(char2pixel(o[r][4]))}break;case"N":(D=new TextBox(oLGWin,g,b,"")).setWidth(char2pixel(o[r][4])),D.setNumericMask(o[r][4],o[r][5],",","",!1,!1,""),"R"==o[r][6]&&((p=new TextBox(oLGWin,g,270,"")).setWidth(char2pixel(o[r][4])),p.setNumericMask(o[r][4],o[r][5],",","",!1,!1,""));break;case"D":D=new DatePicker(oLGWin,g,b,""),"R"==o[r][6]&&(p=new DatePicker(oLGWin,g,270,""));break;default:continue}Label(oLGWin,g,20,o[r][1]),(f=new TextBox(oLGWin,g,440,"")).setWidth(30),f.setNumericMask(1,0,",",".",!1,!1,""),document.getElementById(f.getId()).addEventListener("dblclick",function(){listadoGenOrdenDblClick(this)}),C=new CheckBox(oLGWin,g,500,!1),aLGObjetos.push([r,D,p,f,C]),g+=30}Label(oLGWin,g,20,"Sólo subtotales"),oLGSoloSubs=new CheckBox(oLGWin,g,b,!1);var P=aLGObjetos.length,S=0;for(r=0;r<P;r++)document.getElementById(aLGObjetos[r][1].getId()).tabIndex=++S,null!=aLGObjetos[r][2]&&(document.getElementById(aLGObjetos[r][2].getId()).tabIndex=++S),document.getElementById(aLGObjetos[r][3].getId()).tabIndex=r+100,document.getElementById(aLGObjetos[r][4].getId()).tabIndex=r+200;var W=0;for(r=0;r<aLGListado.length;r++){var w;"Q"!=(w=aLGListado[r])[6]&&(w[9]=0,w[10]=!1,w[11]=W,w[12]="left","L"==w[6]&&0<w[7].length&&(w[4]=parseInt(w[7])),"N"!=w[3]&&"M"!=w[3]||(w[11]=W+w[4]*nChars2mm,w[12]="right"),W+=(w[4]+1)*nChars2mm)}oLGGenerar=new Button(oLGWin,360,150,"Generar","listadoGenericoGenerarClick()"),document.getElementById(oLGGenerar.getId()).tabIndex=300,oLGSalir=new Button(oLGWin,360,280,"Salir","oLGWin.release()"),document.getElementById(oLGSalir.getId()).tabIndex=301,document.getElementById(aLGObjetos[0][1].getId()).focus(),oLGWin.fadeIn()}else alert("No has hecho login")}function listadoGenericoGenerarClick(){for(var e=[],t=[],o="",a="",i="",r="",n=0,s=0;s<aLGObjetos.length;s++){var l=aLGObjetos[s],d=l[0],c="C"==(L=aLGListado[d])[6]?l[1].getSelectedValue():l[1].getValue(),u=null==l[2]?"":l[2].getValue(),g=parseInt(l[3].getValue());if(isNaN(g)&&(g=0),g<1&&l[4].isChecked())return void alert("No se pueden calcular subtotales de un campo no ordenado");if(0<g){for(m=0;m<t.length;m++)if(t[m][0]==g)return void alert("La secuencia de ordenación "+g+" está repetida");t.push([g,d])}switch(L[9]=g,L[10]=l[4].isChecked(),L[10]&&n++,L[8]="",L[6]){case"":case"U":case"C":if(0<c.length)if(0<c.indexOf("|")){var b=c.split("|");c="";for(var D=0;D<b.length;D++)0<D&&(c+=","),c+="'"+b[D]+"'";L[8]=" in("+c+")"}else L[8]="='"+c+"'";break;case"A":0<c.length&&("N"==L[3]?L[8]="="+c:L[8]="='"+c+"'");break;case"M":if(0<c.length){var p=c.split(",");L[8]=" in(";for(D=0;D<p.length;D++)0<D&&(L[8]+=","),"N"==L[3]?L[8]+=p[D]:L[8]+="'"+p[D]+"'";L[8]+=")"}break;case"L":0<c.length&&(L[8]=" ILIKE '%"+c+"%'");break;case"R":0<c.length?u.length<1?L[8]="N"==L[3]?">="+c:">='"+c+"'":L[8]="N"==L[3]?">="+c+" and "+L[0]+"<="+u:">='"+c+"' and "+L[0]+"<='"+u+"'":0<u.length&&(L[8]="N"==L[3]?"<="+u:"<='"+u+"'");break;case"X":var f="=";terminaEnComparador(L[7])&&(f=""),0<c.length&&("N"==L[3]?L[8]=L[7]+f+c:L[8]=L[7]+f+"'"+c+"'")}}if(3<n)alert("Se admite un máximo de 3 niveles de subtotales");else{for(var C=0,A=0;A<aLGListado.length;A++){var L;"Q"==(L=aLGListado[A])[6]?L[8]=L[7]:(0<o.length&&(o+=", "),"X"==L[6]?o+=quitarComparador(L[7]):"D"==L[6]?o+="0.0":o+=L[0]),0<L[8].length&&(0<i.length&&(i+=" and "),"E"==L[6]||"Q"==L[6]?i+=L[8]:("X"==L[6]?i+=L[8]:i+=L[0]+L[8],C++));var E=L[0].split(".")[0];e.indexOf(E)<0&&e.push(E)}if(C<1)alert("No se ha realizado ninguna selección");else{for(A=0;A<e.length;A++)0<a.length&&(a+=", "),a+=e[A];t=t.sort(function(e,t){return e[0]-t[0]});for(A=0;A<t.length;A++){0<r.length&&(r+=", ");var h=t[A][1];"X"==aLGListado[h][6]?r+=quitarComparador(aLGListado[h][7]):r+=aLGListado[h][0]}var G="select "+o+" from "+a;0<i.length&&(G+=" where "+i),0<r.length&&(G+=" order by "+r),listadoGenericoVer(G)}}}function listadoGenericoVer(e){aLGRet=void 0,gLGQuery=e,trabajando(!0),setTimeout(function(){if(aLGRet=httpRequest(sRequestDb,"DBSELECT",sUsuario,gLGQuery),trabajando(!1),!esUnError(aLGRet))if(aLGRet.length<1||aLGRet[0].toString().length<1)alert("No se ha encontrado ningún registro con esas condiciones");else{for(var e=[],t=0;t<aLGListado.length;t++)"Q"!=aLGListado[t][6]&&e.push(aLGListado[t][2]);oLGVWin=new Form("Registros seleccionados ("+aLGRet.length+")",1150,400),oLGVGrid=new Grid(oLGVWin,30,5,1140,310,e,1120,!0,"oLGVGridClick()"),oLGVDetalle=new Button(oLGVWin,360,430,"Detalle","oLGVDetalleClick()"),oLGVDetalle.disable(),oLGVSalir=new Button(oLGVWin,360,560,"Salir","oLGVWin.release()"),oLGVCopy=new Image(oLGVWin,360,1060,"/img/copy.png",30,30,"oLGVCopyClick()"),oLGVCopy.setTooltip("Copiar grid al clipboard"),oLGVPrint=new Image(oLGVWin,360,1100,"/img/printer.png",30,30,"oLGVPrintClick()"),oLGVPrint.setTooltip("Imprimir listado en PDF");var o=null==gLGFDetalle;for(t=0;t<aLGRet.length;t++){oLGVGrid.addRow(aLGRet[t],o);for(var a=0;a<aLGListado.length;a++)if("Q"!=aLGListado[a][6]){if("D"==aLGListado[a][6]){var i=numberToStrSpain(calcularDerived(a,t,!1),2,!0);aLGRet[t][a]=i,oLGVGrid.setCell(t+1,a+1,i)}var r=aLGListado[a][12];oLGVGrid.setCellAlign(t+1,a+1,r)}else a++}oLGVWin.fadeIn()}},50)}function oLGVGridClick(){null!=gLGFDetalle&&(0<oLGVGrid.getFirstSelectedRow()?oLGVDetalle.enable():oLGVDetalle.disable())}function oLGVDetalleClick(){if(null!=gLGFDetalle){var e=oLGVGrid.getFirstSelectedRow();if(!(e<1))if("entrarPartes"==gLGFDetalle)entrarPartes(oLGVGrid.getCell(e,gLGAKeys[0]),oLGVGrid.getCell(e,gLGAKeys[1]),oLGVGrid.getCell(e,gLGAKeys[2]),oLGVGrid.getCell(e,gLGAKeys[3]),!0);else if("detFacEmi"==gLGFDetalle)detFacEmi("V","",oLGVGrid.getCell(e,gLGAKeys[0]),oLGVGrid.getCell(e,gLGAKeys[1]),oLGVGrid.getCell(e,gLGAKeys[2]));else{new Function(gLGFDetalle+"('V', oLGVGrid, gLGAKeys)")("V",oLGVGrid,gLGAKeys)}}}function oLGVCopyClick(){var e=document.getElementById(oLGVGrid.getId());copiaAlClipboard(e)}function listadoGenOrdenDblClick(e){if(0<e.value.length)e.value="";else{for(var t=0,o=0;o<aLGObjetos.length;o++)0<aLGObjetos[o][3].getValue().length&&(t=Math.max(t,parseInt(aLGObjetos[o][3].getValue())));e.value=(t+1).toString()}}function oLGVPrintClick(){var e=aLGRet.length;2e3<e&&!confirm("Se van a imprimir "+e+" registros. Es posible que el navegador no pueda tratar el PDF resultante, o bien deba fraccionar el listado en varios PDFs.\n¿Estás seguro de continuar?")||listadoGenericoPrint()}function calcularDerived(ncampo,nsub,totales){for(var expr=aLGListado[ncampo][7],formula=expr,p1,p2,trozo,npos,valor;!(p1=formula.indexOf("["),p1<0||(p2=formula.indexOf("]"),p2<p1));)trozo=formula.substr(p1,p2-p1+1),npos=parseInt(trozo.substr(1,trozo.length-2)),valor=totales?aLGListado[npos][14+nsub].toString():strToNumberSpain(aLGRet[nsub][npos]).toString(),formula=formula.replace(trozo,valor);return eval(formula)}function reemplazarAyudasInternas(e){if(e.indexOf("[")<0)return e;for(var t,o,a,i,r;0<=(t=e.indexOf("["))&&!((o=e.indexOf("]"))<t+2);){if(a=e.substr(t,o-t+1),NaN==(i=parseInt(a.substr(1,a.length-2)))||i<0)return e.replace(a,"");r=null;for(var n=0;n<aLGObjetos.length;n++)if(aLGObjetos[n][0]==i){r=aLGObjetos[n][1];break}e=r?e.replace(a,"&"+r.getId()+";"):e.replace(a,"")}return e.replaceAll("&","[").replaceAll(";","]")}function listadoGenericoPrint(){if(bInternetExplorer)alert("IExplorer no soporta la impresión en PDF");else{var u=oLGSoloSubs.isChecked();trabajando(!0),setTimeout(function(){for(var e="",t=[],o=0;o<aLGListado.length;o++){1==(l=aLGListado[o])[10]&&0<l[9]&&t.push([o,l[9]]),"M"==l[3]&&(l[13]=0,l[14]=0,l[15]=0,l[16]=0),l[8].length<1||"E"==l[6]||(0<e.length&&(e+=" and "),"X"==l[6]||"Q"==l[6]?e+=l[8]:e+=l[0].split(".")[1]+l[8],e=e.replaceAll(gLGTabla+".",""))}if(0<t.length){t=t.sort(function(e,t){return e[1]-t[1]});for(o=0;o<t.length;o++)0<aLGRet.length?t[o][1]=aLGRet[0][t[o][0]]:t[o][1]=""}var a=new jsPDF("l","mm","a4",!0);a.setProperties({title:gLGTitulo}),a.setFont("courier"),a.setFontSize(9);var i={newDoc:!1,page:0,line:0,xmargin:15,ymargin:25,xdelta:nChars2mm,ydelta:4,filtro:e,subs:t,gety:function(){return this.ymargin+this.line*this.ydelta}};if(0<aLGRet.length)for(var r=0;r<i.subs.length;r++)i.subs[r][1]=aLGRet[0][i.subs[r][0]];listadoGenericoPrintCabecero(a,i);for(o=0;o<aLGRet.length;o++){listadoGenericoCheckSubtotales(o,a,i);for(var n=i.gety(),s=0;s<aLGListado.length;s++){var l;if("Q"!=(l=aLGListado[s])[6]){var d=i.xmargin+l[11],c=aLGRet[o][s];if(c.length>l[4]&&(c=c.substr(0,l[4])),u||a.text(c,d,n,l[12]),"M"==l[3])for(r=0;r<4;r++)l[13+r]+=strToNumberSpain(c)}}u||i.line++,195<i.gety()&&(i.page%30==0&&(renderPdf(a,gLGTitulo+"-"+i.page),(a=new jsPDF("l","mm","a4",!0)).setProperties({title:gLGTitulo}),a.setFont("courier"),a.setFontSize(9),i.newDoc=!0),listadoGenericoPrintCabecero(a,i))}listadoGenericoCheckSubtotales(-1,a,i),trabajando(!1),renderPdf(a,gLGTitulo+"-"+i.page)},50)}}function listadoGenericoCheckSubtotales(e,t,o){for(var a=0;a<o.subs.length;a++){var i=o.subs[a][1],r="";if(-1<e)r=aLGRet[e][o.subs[a][0]];if(r!=i){for(var n=o.subs.length-1;a<=n;n--)listadoGenericoPrintSubtotal(n,e,t,o);break}}e<0&&listadoGenericoPrintSubtotal(-1,-1,t,o)}function listadoGenericoPrintSubtotal(e,t,o,a){var i=["#646464","#cce0ff","#feffcc","#E6E6E6"];if(o.setFontType("bold"),e<0)o.text("Totales listado",a.xmargin,a.gety());else for(var r=(b=a.gety())-a.ydelta+1,n=e;-1<n;n--){o.setFillColor(i[e+1]);var s=aLGListado[a.subs[n][0]],l=a.xmargin+s[11],d="right"==s[12]?l-s[4]*a.xdelta:l;if(o.rect(d,r,s[4]*a.xdelta,a.ydelta-.1,"F"),o.text(a.subs[n][1],l,b,s[12]),"number"==typeof s[20]){var c=s[20];if(!(c<0)){var u,m=aLGListado[c];(u=t<0?aLGRet[aLGRet.length-1][c]:aLGRet[t-1][c]).length>m[4]&&(u=u.substr(0,m[4]));l=a.xmargin+m[11],d="right"==m[12]?l-m[4]*a.xdelta:l;o.setFillColor(i[e+1]),o.rect(d,r,m[4]*a.xdelta,a.ydelta-.1,"F"),o.text(u,l,b,m[12])}}}o.setFillColor(0);for(var g=0;g<aLGListado.length;g++)"D"==aLGListado[g][6]&&(aLGListado[g][14+e]=numberToStrSpain(calcularDerived(g,e,!0),2,!0));for(g=0;g<aLGListado.length;g++){if("Q"!=(s=aLGListado[g])[6]&&"M"==s[3]){l=a.xmargin+s[11];var b=a.gety();o.setFillColor(i[e+1]),o.rect(l-s[4]*a.xdelta,b-a.ydelta+1,s[4]*a.xdelta,a.ydelta-.1,"F"),e<0?o.setTextColor(255,255,255):o.setTextColor(0),o.text(numberToStrSpain(s[14+e],2,!0),l,b,"right"),s[14+e]=0}}o.setFontType("normal"),o.setFillColor(0),o.setTextColor(0),-1<e&&(a.subs[e][1]=t<0?"":aLGRet[t][a.subs[e][0]]),a.line++}function listadoGenericoPrintCabecero(e,t){t.page++,1<t.page&&!t.newDoc&&e.addPage(),t.newDoc=!1,t.line=0,e.addImage(dameLogo(),"png",15,10,50,13,"LogoCK","FAST"),e.setFontType("bold"),e.text(gLGTitulo,148,t.gety(),"center"),t.line+=2,e.text("Filtro: "+t.filtro,t.xmargin,t.gety()),e.text("Página "+t.page,297-t.xmargin,t.gety(),"right"),e.setFontType("normal"),t.line+=2;for(var o=0;o<aLGListado.length;o++){var a=aLGListado[o];if("Q"!=a[6]){var i=t.xmargin+a[11];"right"==a[12]&&(i-=a[4]*t.xdelta);var r=t.gety()-t.ydelta+1.25,n=a[4]*t.xdelta,s=t.ydelta-.1;e.setFillColor(100,100,100),e.rect(i,r,n,s,"F"),e.setTextColor(255,255,255),e.setFontType("bold"),e.text(a[2],t.xmargin+a[11],t.gety(),a[12])}}e.setDrawColor(0),e.setFillColor(0),e.setTextColor(0),e.setFontType("normal"),t.line+=1}function listadoFacturas(){listadoGenerico("facturas","Facturas Emitidas",[["proyecto","Proyecto","Pro","C",3,0,"A","proyecto:codigo:descrip"],["proyecto.descrip","","Descripción","C",14,0,"E","proyecto=codigo->0"],["trabajo","Trabajo","Trb","C",3,0,"A","codtrab:trabajo:descrip:proyecto=[0]"],["codtrab.descrip","","Descripción","C",14,0,"E","proyecto=proyecto,trabajo=trabajo->2"],["numero","","Num","C",3,0,"",""],["estado","Estado","E","C",1,0,"C","=---,E|P=Pendiente de cobro,C=Cobrada,P=Cobro parcial"],["fechaemi","Año emisión","Año","N",4,0,"X","extract(year from facturas.fechaemi)"],["fechaemi","Mes emisión","Ms","N",2,0,"X","extract(month from facturas.fechaemi)"],["fechaemi","Emitida del/al","Emitida","D",10,0,"R",""],["fechavto","Vence del/al","Vence","D",10,0,"R",""],["fechacbr","","Cobrada","D",10,0,"",""],["fechavto","Antigüedad >","Ant","N",3,0,"X","iif(facturas.estado in ('E','P'), current_date - facturas.fechavto, 0)>"],["ptsneto","","Importe","M",13,2,"",""],["ptsiva","","IVA","M",12,2,"",""],["ptstotal","","Total","M",13,2,"",""],["ptscobr","","Cobrado","M",13,2,"",""]],"detFacEmi",[1,3,5])}function listadoHoras(){listadoGenerico("partes","Horas Incurridas",[["anno","Año","Año","N",4,0,"",""],["mes","Mes","Mes","N",3,0,"",""],["semana","Semana","Sem","N",3,0,"",""],["siglas","Siglas","Sig","C",3,0,"A","recursos:siglas:nombre"],["proyecto","Proyecto","Pro","C",3,0,"R",""],["proyecto.descrip","","Descripcion","C",25,0,"E","proyecto=codigo->4"],["trabajo","Trabajo","Trb","C",3,0,"R",""],["codtrab.descrip","","Descripcion","C",25,0,"E","proyecto=proyecto,trabajo=trabajo->6"],["visado","Visado","Vis","C",3,0,"A","recursos:siglas:nombre"],["fechav","","Fecha V","D",10,0,"",""],["tunid","Unidades","U","C",1,0,"C","=---,H=Horas normales,S=Semanas guardia no presencial,G=Dias guardia no presencial,D=Dias disponibilidad presencial,P=Horas disponbilidad presencial"],["normales","","Horas","M",11,2,"X","iif(partes.tunid=' ' or partes.tunid='H', partes.normales, 0.0)"],["normales","","DispH","M",8,2,"X","iif(partes.tunid='P', partes.normales, 0.0)"],["normales","","DispD","M",8,2,"X","iif(partes.tunid='D', partes.normales, 0.0)"],["normales","","GuarD","M",8,2,"X","iif(partes.tunid='G', partes.normales, 0.0)"],["normales","","GuarS","M",8,2,"X","iif(partes.tunid='S', partes.normales, 0.0)"]],"entrarPartes",[1,2,3,4])}function listadoHorasCostes(){listadoGenerico("partes","Horas y Costes",[["anno","Año","Año","N",4,0,"",""],["mes","Mes","Mes","N",3,0,"R",""],["semana","Semana","Sem","N",3,0,"",""],["proyecto","Proyecto","Pro","C",3,0,"R",""],["proyecto.descrip","","Descripcion","C",25,0,"E","proyecto=codigo->3"],["trabajo","Trabajo","Trb","C",3,0,"R",""],["codtrab.descrip","","Descripcion","C",25,0,"E","proyecto=proyecto,trabajo=trabajo->5"],["siglas","Siglas","Sig","C",3,0,"A","recursos:siglas:nombre"],["codtrab.division","Tipo Serv","Tipo","C",4,0,"U",""],["recursos.nombre","","Nombre","C",25,0,"E","siglas=siglas"],["recursos.categoria","","Cat","C",4,0,"",""],["recursos.coste_dir","","C/H","N",6,2,"E","siglas=siglas"],["normales","","Horas","M",11,2,"",""],["filler","","Coste","M",14,2,"X","partes.normales*recursos.coste_dir"],["filler","","","C",0,0,"Q","partes.tunid='H' and codtrab.division<>'NOC'"]],"entrarPartes",[1,2,3,8])}function listadoDetalleCostes(){listadoGenerico("partes","Detalle Costes",[["anno","Año","Año","N",4,0,"",""],["mes","Mes","Mes","N",3,0,"R",""],["semana","Semana","Sem","N",3,0,"",""],["proyecto","Proyecto","Pro","C",3,0,"R",""],["proyecto.descrip","","Descripcion","C",15,0,"E","proyecto=codigo->3"],["trabajo","Trabajo","Trb","C",3,0,"R",""],["codtrab.descrip","","Descripcion","C",15,0,"E","proyecto=proyecto,trabajo=trabajo->5"],["codtrab.division","Tipo Serv","Tipo","C",4,0,"U",""],["siglas","Siglas","Sig","C",3,0,"A","recursos:siglas:nombre"],["normales","","Horas","M",10,2,"",""],["recursos.coste_dir","","C/H","N",6,2,"E","siglas=siglas"],["recursos.coste_dir","","Coste","M",12,2,"X","recursos.coste_dir*partes.normales"],["recursos.categoria","","Cat","C",4,0,"",""],["codtrab.tarifa","","Tar","C",4,0,"",""],["tarifas.precio","","P/H","N",6,2,"E","tarifas.tarifa=codtrab.tarifa,(tarifas.categoria=recursos.categoria or tarifas.categoria='*')"],["filler","","Precio","M",12,2,"X","tarifas.precio*partes.normales"],["filler","","M. Buto","M",12,2,"X","(tarifas.precio-recursos.coste_dir)*partes.normales"],["filler","","%MB","M",7,2,"D","([15]==0.0 ? 0.0 : [16]/[15]*100)"],["filler","","","C",0,0,"Q","partes.tunid='H' and codtrab.division<>'NOC'"]],"entrarPartes",[1,2,3,9])}function listadoResumenGuardias(){listadoGenerico("partes","Resumen Guardias",[["anno","Año","Año","N",4,0,"",""],["mes","Mes","Mes","N",3,0,"",""],["semana","Semana","Sem","N",3,0,"",""],["siglas","Siglas","Sig","C",3,0,"A","recursos:siglas:nombre"],["recursos.nombre","","Nombre","C",20,0,"E","siglas=siglas->3"],["proyecto","Proyecto","Pro","C",3,0,"",""],["proyecto.descrip","","Descripcion","C",25,0,"E","proyecto=codigo->5"],["trabajo","Trabajo","Trb","C",3,0,"",""],["codtrab.descrip","","Descripcion","C",30,0,"E","proyecto=proyecto,trabajo=trabajo->7"],["tunid","","T","C",1,0,"",""],["normales","","Numero","N",6,2,"",""],["recursos.categoria","","Cat","C",4,0,"",""],["codtrab.tarifa","","Tar","C",4,0,"",""],["tarifas.precio","","P/U","N",6,2,"E","tarifas.tarifa=codtrab.tarifa,(tarifas.categoria=recursos.categoria or tarifas.categoria='*')"],["filler","","Precio","M",12,2,"X","tarifas.precio*partes.normales"],["filler","","","C",0,0,"Q","partes.tunid<>'H' and codtrab.division<>'NOC'"]],"entrarPartes",[1,2,3,4])}function listadoDetalleCostesTipo(){listadoGenerico("partes","Costes, Márgenes y Tipos",[["anno","Año","Año","N",4,0,"R",""],["mes","Mes","Mes","N",3,0,"",""],["semana","Semana","Sem","N",3,0,"",""],["proyecto","Proyecto","Pro","C",3,0,"R",""],["trabajo","Trabajo","Trb","C",3,0,"R",""],["codtrab.descrip","","Descripcion","C",25,0,"E","proyecto=proyecto,trabajo=trabajo->4"],["codtrab.division","Tipo","Tipo","C",4,0,"C","=---,AUS=Ausencias,ADM=Administracion,COM=Comercial,IDI=I+D+I,TEC=Tecnologia,RRHH=Recursos Humanos,AT=Asistencia Tecnica,PC=Proyectos Cerrados,MTO=Mantenimiento,SOP=Soporte,SLA=SLA,NOF=No Facturables"],["siglas","Siglas","Sig","C",3,0,"A","recursos:siglas:nombre"],["normales","","Horas","M",10,2,"",""],["recursos.coste_dir","","C/H","N",6,2,"E","siglas=siglas"],["recursos.coste_dir","","Coste","M",14,2,"X","recursos.coste_dir*partes.normales"],["recursos.categoria","","Cat","C",4,0,"",""],["codtrab.tarifa","","Tar","C",4,0,"",""],["tarifas.precio","","P/H","N",6,2,"E","tarifas.tarifa=codtrab.tarifa,(tarifas.categoria=recursos.categoria or tarifas.categoria='*')"],["filler","","Precio","M",14,2,"X","tarifas.precio*partes.normales"],["filler","","M. Buto","M",14,2,"X","(tarifas.precio-recursos.coste_dir)*partes.normales"],["filler","","%MB","M",7,2,"D","([14]==0.0 ? 0.0 : [15]/[14]*100)"],["filler","","","C",0,0,"Q","partes.tunid='H'"]],"entrarPartes",[1,2,3,8])}function listadoFacRec(){listadoGenerico("facrec","Facturas Recibidas",[["proveedor","Proveedor","Proveedor","C",16,0,"A","proveedor:codigo:nombre"],["factura","","Fac/Prf/Ped","C",11,0,"",""],["fechaemi","Emitida","Emitida","D",10,0,"R",""],["concepto","Concepto Like","Concepto","C",17,0,"L",""],["estado","Estado","E","C",1,0,"C","=---,R=Recibida,P=Pagada,N=No conforme"],["fechavto","Vence","Vence","D",10,0,"R",""],["fechapag","Pagada","Pagada","D",10,0,"R",""],["notas","Notas Like","Notas","C",17,0,"L",""],["mediop","","Pago","C",4,0,"L",""],["banco","","Banco","C",10,0,"L",""],["tipog","Tip. Gasto","T","C",1,0,"C","=---,I=Inmovilizado,G=Gastos Generales,R=Gastos Reembolsables,S=Subcontrata,O=Otros"],["neto","","Neto","M",12,2,"",""],["importe","","Total","M",12,2,"",""]],"detFacRec",[1,2])}function listadoNotGas(){listadoGenerico("notas","Notas de Gasto",[["nota","","Nota","N",5,0,"",""],["anno","Año","Año","N",4,0,"",""],["fecha","Fecha","Fecha","D",10,0,"R",""],["proyecto","Proyecto","Pro","C",3,0,"",""],["proyecto.descrip","","Descripción","C",28,0,"E","proyecto=codigo"],["trabajo","Trabajo","Trb","C",3,0,"",""],["codtrab.descrip","","Descripción","C",30,0,"E","proyecto=proyecto,trabajo=trabajo"],["siglas","Siglas","Sig","C",3,0,"U",""],["motivo","Motivo","Motivo","C",30,0,"L",""],["clase","Clase","C","C",1,0,"C","=---,S=Subcontrata,M=Materiales,G=Reembolsables,O=Otros"],["importe","","Importe","M",14,2,"",""]])}function listadoDocumentos(){listadoGenerico("documen","Documentos",[["proyecto","Proyecto","Pro","C",3,0,"A","proyecto:codigo:descrip"],["tipo","Tipo","Tp","C",2,0,"A","Tipos:Tipo:Descrip"],["numero","Número","Num","N",3,0,"R",""],["revision","Revisión","Rev","N",3,0,"",""],["ultrev","Sólo Ult. Rev","U","C",1,0,"C","*=Si,=No"],["autor","Autor","Sig","C",3,0,"A","recursos:siglas:nombre"],["fecha","Fecha","Fecha","D",10,0,"R",""],["titulo","Titulo like","Titulo","C",30,0,"L","50"],["archivo","Archivo like","Archivo","C",30,0,"L","58"]])}function listDoc(){if(0!=bLoggedIn){if(gLDRegdoc=!1,aUsuRoles.indexOf("ADMON")<0){if(aUsuRoles.indexOf("REGDOC")<0)return void alert("Opción reservada para roles ADMON y REGDOC");gLDRegdoc=!0}oLstWin=new Form("Registro de Documentos",870,300),oLstGrid=new Grid(oLstWin,30,10,850,170,["Proy","Tip","Num","Rev","Trb","Aut","Fecha","Titulo","Archivo"],840,!0,"listDocClick()");var e=220,t=20;Label(oLstWin,e,t,"Proyecto"),t+=70,oProy=new TextBox(oLstWin,e,t,"",!1,"proyectoOnChange(this)","proy"),oProy.setWidth(40),t+=50,oProyHelp=new Button(oLstWin,e,t,"?","ayudaProy(this)",20,22),document.getElementById(oProyHelp.getId()).tabIndex=-1,t+=30,oProyDesc=new Label(oLstWin,e,t,"","","","proyDesc"),t=500,Label(oLstWin,e,t,"Tipo"),t+=40,oTipo=new TextBox(oLstWin,e,t,"",!1,"ayudaSimpleOnChange(this, true)"),oTipo.setWidth(30),t+=40,oTipoHelp=new Button(oLstWin,e,t,"?","ayudaSimple(this)",20,22),prepararAyudaSimple(oTipo,oTipoHelp,null,"Tipos:Tipo:Descrip"),t+=40,Label(oLstWin,e,t,"Número"),t+=60,oNum=new TextBox(oLstWin,e,t,"",!1,""),oNum.setNumericMask(3,0,",","",!1,!1,""),oNum.setWidth(40),t+=60,Label(oLstWin,e,t,"Autor"),t+=40,oAutor=new TextBox(oLstWin,e,t,"",!1,"ayudaSimpleOnChange(this, true)"),oAutor.setWidth(40),t+=50,oAutorHelp=new Button(oLstWin,e,t,"?","ayudaSimple(this)",20,22),prepararAyudaSimple(oAutor,oAutorHelp,null,"Recursos:Siglas:Nombre"),t=20,e=260,oLstBusc=new Button(oLstWin,e,t,"Buscar","listDocBuscar(true)",110),oLstBusc.setTooltip("Buscar documentos con los datos indicados"),t+=120,oLstAlta=new Button(oLstWin,e,t,"Alta","detDoc('A')",110),oLstAlta.setTooltip("Registrar un nuevo documento"),t+=120,oLstVers=new Button(oLstWin,e,t,"Nueva Revisión","detDoc('V')",110),oLstVers.setTooltip("Registrar una nueva version del documento"),t+=120,oLstEdit=new Button(oLstWin,e,t,"Editar","detDoc('U')",110),oLstEdit.setTooltip("Editar datos del documento"),t+=120,oLstElim=new Button(oLstWin,e,t,"Eliminar","listDocDel()",110),oLstElim.setTooltip("Eliminar el documento"),t+=120,oLstHist=new Button(oLstWin,e,t,"Historia","listDocHist()",110),oLstHist.setTooltip("Historia del documento"),t+=120,Button(oLstWin,e,t,"Salir","oLstWin.release()",110),oLstVers.disable(),oLstEdit.disable(),oLstElim.disable(),oLstHist.disable(),oProy.setFocus(),oLstWin.fadeIn()}else alert("No has hecho login")}function listDocClick(){0<oLstGrid.getSelectedRowCount()?(oLstAlta.disable(),oLstEdit.enable(),oLstVers.enable(),oLstElim.enable(),oLstHist.enable()):(oLstAlta.enable(),oLstEdit.disable(),oLstVers.disable(),oLstElim.disable(),oLstHist.disable()),gLDRegdoc&&oLstElim.disable()}function listDocBuscar(e){""!=oProy.getValue()||""!=oTipo.getValue()||""!=oNum.getValue()||""!=oAutor.getValue()?(trabajando(!0),setTimeout(function(){var e=oProy.getValue();""==e&&(e=" ");var t=oTipo.getValue();""==t&&(t=" ");var o=oNum.getValue();""==o&&(o=" ");var a=oAutor.getValue();""==a&&(a=" ");var i=httpRequest(sRequestAdmdoc,"LISTDOC",sUsuario,e,t,o,a);if(esUnError(i))trabajando(!1);else{for(;1<oLstGrid.getRowCount();)oLstGrid.deleteRow(1);var r=i.length;if(""==i[0]&&(r=0),0<r)for(var n=0;n<r;n++)oLstGrid.addRow(i[n],!1),oLstGrid.setCellAlign(n+1,3,"right"),oLstGrid.setCellAlign(n+1,4,"right");else alert("No se encuentran documentos con esos datos");oLstAlta.enable(),oLstVers.disable(),oLstEdit.disable(),oLstElim.disable(),oLstHist.disable(),oProy.setFocus(),trabajando(!1)}},50)):e&&alert("Debes definir algún criterio de búsqueda")}function listDocDel(){var e=oLstGrid.getFirstSelectedRow();if(!(e<1))if(aUsuRoles.indexOf("ADMON")<0)alert("Opción reservada a Administración");else if(confirm("¿Estás seguro de eliminar esta revisión?")){var t=[oLstGrid.getCell(e,1),oLstGrid.getCell(e,2),oLstGrid.getCell(e,3),oLstGrid.getCell(e,4),"","","","","",""],o=httpRequest(sRequestAdmdoc,"UPDDOC",sUsuario,"D",t);esUnError(o)||(alert("Documento eliminado con éxito"),listDocBuscar(!1))}}function listDocHist(){var e=oLstGrid.getFirstSelectedRow();if(!(e<1)){oHistWin=new Form("Historia de un Documento",770,270),oHistGrid=new Grid(oHistWin,30,10,750,180,["Proy","Tip","Num","Rev","U","Trb","Aut","Fecha","Titulo","Archivo"],740,!0,""),Button(oHistWin,225,350,"Salir","oHistWin.release()");var t=httpRequest(sRequestAdmdoc,"GETDOC",sUsuario,oLstGrid.getCell(e,1),oLstGrid.getCell(e,2),oLstGrid.getCell(e,3));if(esUnError(t))oHistWin.release();else{for(;1<oHistGrid.getRowCount();)oHistGrid.deleteRow(1);var o=t.length;if(""==t[0]&&(o=0),0<o)for(var a=0;a<o;a++)oHistGrid.addRow(t[a],!0),oHistGrid.setCellAlign(a+1,3,"right"),oHistGrid.setCellAlign(a+1,4,"right");oHistWin.fadeIn()}}}function listFacEmi(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0)alert("Opción reservada para Administración");else{gLFETieneTodo=0<=aUsuRoles.indexOf("TODO"),oWin=new Form("Facturas emitidas",990,410),oGrid=new Grid(oWin,30,5,980,240,["Proy","Trab","Num","F. Emision","F. Vencim.","Neto","Total","Est","F. Cobro","Cobrado","Del año","Del mes"],960,!0,"listFacEmiClick()");var e=290,t=50;Label(oWin,e,t,"Proyecto"),t+=70,oProy=new TextBox(oWin,e,t,"",!1,"proyectoOnChange(this)","proy"),oProy.setWidth(40),t+=50,oProyHelp=new Button(oWin,e,t,"?","ayudaProy(this)",20,22),document.getElementById(oProyHelp.getId()).tabIndex=-1,t+=30,oProyDesc=new Label(oWin,e,t,"","","","proyDesc"),t=50,e+=30,Label(oWin,e,t,"Trabajo"),t+=70,oTrab=new TextBox(oWin,e,t,"",!1,"trabajoOnChange(this, true)","trab"),oTrab.setWidth(40),t+=50,oTrabHelp=new Button(oWin,e,t,"?","ayudaTrab(this)",20,22),document.getElementById(oTrabHelp.getId()).tabIndex=-1,t+=30,oTrabDesc=new Label(oWin,e,t,"","","","trabDesc"),e=290,t=650,Label(oWin,e,t,"Emitida en"),t+=80,oMes=new ComboBox(oWin,e,t,["---","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["*","1","2","3","4","5","6","7","8","9","10","11","12"],0),t+=100,Label(oWin,e,t,"del"),t+=30,oAnno=new ComboBox(oWin,e,t,["---","2017","2018","2019","2020","2021","2022"],["*","2017","2018","2019","2020","2021","2022"],0),e=360,t=20,oBusc=new Button(oWin,e,t,"Buscar","facEmiBuscClick(false)",100),t+=110,oPdtes=new Button(oWin,e,t,"Pendientes","facEmiPdtesClick()",100),t+=110,oAlta=new Button(oWin,e,t,"Alta","listFacEmiAlta()",100),t+=110,oVer=new Button(oWin,e,t,"Ver","listFacEmiOtros('V')",100),t+=110,oCobrar=new Button(oWin,e,t,"Cobrar","listFacEmiOtros('C')",100),t+=110,oEditar=new Button(oWin,e,t,"Editar","listFacEmiOtros('U')",100),t+=110,oElim=new Button(oWin,e,t,"Eliminar","facEmiElimClick()",100),t+=180,oSalir=new Button(oWin,e,t,"Salir","oWin.release()",100),oVer.disable(),oCobrar.disable(),oElim.disable(),oEditar.disable(),oAlta.enable(),oPdtes.enable(),oWin.fadeIn()}else alert("No has hecho login")}function listFacEmiAlta(){var e,t;""!=oProy.getValue()&&(e=oProy.getValue()),""!=oTrab.getValue()&&(t=oTrab.getValue()),detFacEmi("A","facEmiBuscClick",e,t)}function listFacEmiOtros(e){var t=oGrid.getFirstSelectedRow();t<1||detFacEmi(e,"facEmiBuscClick",oGrid.getCell(t,1),oGrid.getCell(t,2),oGrid.getCell(t,3))}function facEmiBuscClick(e){var t=oProy.getValue();""==t&&(t="*");var o=oTrab.getValue();""==o&&(o="*");var a=oAnno.getSelectedValue(),r=oMes.getSelectedValue();if("*"!=t||"*"!=o||"*"!=a||"*"!=r){var n=httpRequest(sRequestFacemi,"LISTFACEMI",sUsuario,t,o,a,r);if(!esUnError(n)){for(;1<oGrid.getRowCount();)oGrid.deleteRow(1);if(oVer.disable(),oCobrar.disable(),oElim.disable(),oEditar.disable(),oAlta.enable(),oPdtes.enable(),0<n.length&&""!=n[0])for(i=0;i<n.length;i++)oGrid.addRow(n[i]),oGrid.setCellAlign(i+1,6,"right"),oGrid.setCellAlign(i+1,7,"right"),oGrid.setCellAlign(i+1,10,"right"),oGrid.setCellAlign(i+1,11,"right"),oGrid.setCellAlign(i+1,12,"right");else alert("No hay facturas con esos datos")}}else{for(;1<oGrid.getRowCount();)oGrid.deleteRow(1);e||alert("Debes definir algún criterio de búsqueda")}}function listFacEmiClick(){var e=oGrid.getFirstSelectedRow();if(e<1)oVer.disable(),oCobrar.disable(),oElim.disable(),oEditar.disable(),oAlta.enable(),oPdtes.enable();else{oAlta.disable(),oPdtes.disable(),oVer.enable();var t=oGrid.getCell(e,8);"C"==t||"P"==t||"A"==t?(oCobrar.disable(),oElim.disable(),gLFETieneTodo?oEditar.enable():oEditar.disable()):(oCobrar.enable(),gLFETieneTodo&&oElim.enable(),oEditar.enable())}}function facEmiElimClick(){var e=oGrid.getFirstSelectedRow();if(!(e<1))if(gLFETieneTodo)if(0==strToNumberSpain(oGrid.getCell(e,10))){if(confirm("¡¡ATENCION!! Eliminar una factura definitiva es un proceso muy delicado. ¿Estás seguro de eliminarla?")){var t=httpRequest(sRequestFacemi,"DELFACEMI",sUsuario,oGrid.getCell(e,1),oGrid.getCell(e,2),oGrid.getCell(e,3));esUnError(t)||(alert("Factura eliminada"),facEmiBuscClick(!0))}}else alert("No se puede eliminar una factura cobrada total o parcialmente");else alert("Opción reservada para Dirección Financiera")}function facEmiPdtesClick(){var e=oProy.getValue();""==e&&(e=" ");var t=oTrab.getValue();""==t&&(t=" "),pdtesFacturar("facEmiBuscClick",e,t)}function listFacRec(){0!=bLoggedIn?aUsuRoles.indexOf("ADMON")<0?alert("Opción reservada para Administración"):(gLFRTieneTodo=0<=aUsuRoles.indexOf("TODO"),oLstWin=new Form("Facturas recibidas",900,400),oLstGrid=new Grid(oLstWin,30,5,885,270,["Proveedor","Número","Num Prev","Concepto","Importe","Est","F. Emi","F. Vto"],870,!0,"listFacRecClick()"),Label(oLstWin,310,20,"Proveedor"),oLstProv=new TextBox(oLstWin,310,100,"",!1,""),oLstProv.setTooltip("Entra primeras letras y pulsa <tabulador>"),document.getElementById(oLstProv.getId()).addEventListener("keydown",function(e){9==e.which&&listFacRecHelp()}),oLstProv.setWidth(150),oLstName=new Label(oLstWin,310,260,""),Label(oLstWin,310,680,"Estado"),oLstEstad=new ComboBox(oLstWin,310,740,["---","Recibida","Pagada","No conforme"],["","R","P","N"],0,"listFacRecEstadChange()"),oLstAlta=new Button(oLstWin,350,10,"Alta","listFacRecAlta()"),oLstAlta.setTooltip("Registrar una nueva factura o proforma"),oLstEdit=new Button(oLstWin,350,135,"Editar","listFacRecEdit()"),oLstEdit.setTooltip("Editar una factura o proforma"),oLstPay=new Button(oLstWin,350,260,"Pagar","listFacRecPay()"),oLstPay.setTooltip("Registrar datos de pago de una factura"),oLstDefi=new Button(oLstWin,350,385,"Num Definitivo","listFacRecDef()"),oLstDefi.setTooltip("Asignar no. de factura a una proforma"),oLstElim=new Button(oLstWin,350,510,"Eliminar","listFacRecElim()"),oLstElim.setTooltip("Eliminar una factura o proforma"),oLstAlta.enable(),oLstEdit.disable(),oLstPay.disable(),oLstDefi.disable(),oLstElim.disable(),oLstExit=new Button(oLstWin,350,735,"Salir","listFacRecExit()"),oLstProv.setFocus(),oLstWin.fadeIn()):alert("No has hecho login")}function listFacRecExit(){oLstWin.release()}function listFacRecClick(){var e=oLstGrid.getFirstSelectedRow();0<e?(oLstAlta.disable(),oLstEdit.enable(),gLFRTieneTodo?oLstElim.enable():oLstElim.disable(),"R"==oLstGrid.getCell(e,6)?oLstPay.enable():oLstPay.disable(),ckIsEmpty(oLstGrid.getCell(e,3))?oLstDefi.enable():oLstDefi.disable()):(oLstAlta.enable(),oLstEdit.disable(),oLstPay.disable(),oLstDefi.disable(),oLstElim.disable())}function listFacRecGet(){var e=oLstProv.getValue(),t=oLstEstad.getSelectedValue();if(ckIsEmpty(e)&&ckIsEmpty(t))alert("Debes indicar algún criterio de busqueda");else{ckIsEmpty(e)&&(e=" "),ckIsEmpty(t)&&(t=" ");var o=httpRequest(sRequestFacrec,"LISTFACREC",sUsuario,e,t);if(!esUnError(o)){for(;1<oLstGrid.getRowCount();)oLstGrid.deleteRow(1);var a=o.length;if(""==o[0]&&(a=0),0<a)for(var i=0;i<a;i++){switch(oLstGrid.addRow(o[i],!1),oLstGrid.setCellAlign(i+1,5,"right"),oLstGrid.getCell(i+1,6)){case"P":oLstGrid.setCellColor(i+1,6,"white","green");break;case"N":oLstGrid.setCellColor(i+1,6,"white","red");break;case"A":oLstGrid.setCellColor(i+1,6,"black","yellow")}}else alert("No se encuentran facturas de ese Proveedor en ese Estado");oLstAlta.enable(),oLstEdit.disable(),oLstPay.disable(),oLstDefi.disable(),oLstElim.disable()}}}function listFacRecEstadChange(){listFacRecGet()}function listFacRecHelp(){var e=trim(oLstProv.getValue()).toUpperCase();for(oLstProv.setValue(e);1<oLstGrid.getRowCount();)oLstGrid.deleteRow(1);var t=httpRequest(sRequest,"HLPPROVE",sUsuario,e);if(esUnError(t))return oLstProv.setValue(""),void oLstName.setValue("");var o=t.length;if(""==t[0]&&(o=0),0==o)return alert("No se han encontrado proveedores con esos datos"),oLstProv.setValue(""),void oLstName.setValue("");if(1==o)return oLstProv.setValue(trim(t[0][0])),oLstName.setValue(trim(t[0][1])),void listFacRecGet();oWinPrv=new Form("Proveedores",565,270),oGridPrv=new Grid(oWinPrv,40,15,530,150,["Código","Nombre"],510),bSel=new Button(oWinPrv,210,160,"Seleccionar","gridPrvSelect()"),Button(oWinPrv,210,290,"Salir","oWinPrv.release()");for(var a=0;a<t.length;a++)oGridPrv.addRow(t[a]);oWinPrv.fadeIn()}function gridPrvSelect(){var e=getSeleccion(oGridPrv);if(!(e<0)){var t=trim(oGridPrv.getCell(e,1)),o=trim(oGridPrv.getCell(e,2));oLstProv.setValue(t),oLstName.setValue(o),listFacRecGet(),oWinPrv.release()}}function listFacRecAlta(){detFacRec("A")}function listFacRecEdit(){getSeleccion(oLstGrid)<0||detFacRec("E")}function listFacRecPay(){getSeleccion(oLstGrid)<0||detFacRec("P")}function listFacRecDef(){getSeleccion(oLstGrid)<0||detFacRec("D")}function listFacRecElim(){var e=getSeleccion(oLstGrid);if(!(e<0)&&gLFRTieneTodo){var t=trim(oLstGrid.getCell(e,1)),o=trim(oLstGrid.getCell(e,2));if(confirm("¿Estás absolutamente seguro de eliminar la factura "+o+"\ndel proveedor "+t+"?. Todos los datos se perderán")){aDatos=[],aDatos[0]=t,aDatos[1]=o;var a=httpRequest(sRequestFacrec,"DELFACREC",sUsuario,aDatos);esUnError(a)||listFacRecGet()}}}function listNotGas(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0)alert("Opción reservada para Administración");else{oLstWin=new Form("Notas de Gastos",770,300),oLstGrid=new Grid(oLstWin,30,10,750,170,["Nota","Año","Fecha","Proy","Trab","Sigl","Cls","Motivo","Importe"],730,!0,"listNotGasClick()");var e=220,t=20;Label(oLstWin,e,t,"Proyecto"),t+=70,oProy=new TextBox(oLstWin,e,t,"",!1,"proyectoOnChange(this)","proy"),oProy.setWidth(40),t+=50,oProyHelp=new Button(oLstWin,e,t,"?","ayudaProy(this)",20,22),document.getElementById(oProyHelp.getId()).tabIndex=-1,t+=30,oProyDesc=new Label(oLstWin,e,t,"","","","proyDesc"),t=470,Label(oLstWin,e,t,"Clase"),t+=50,oClase=new ComboBox(oLstWin,e,t,["---","Subcontrata","Materiales","Reembolsables","Otros"],[" ","S","M","G","O"],0),t+=130,Label(oLstWin,e,t,"Año"),t+=40,oAnno=new ComboBox(oLstWin,e,t,["---","2017","2018","2019","2020","2021","2022"],[" ","2017","2018","2019","2020","2021","2022"],0),e=260,t=60,oBusc=new Button(oLstWin,e,t,"Buscar","notGasBuscClick(true)"),t+=130,oAlta=new Button(oLstWin,e,t,"Alta","detNotGas('A')"),t+=130,oEditar=new Button(oLstWin,e,t,"Editar","detNotGas('U')"),t+=130,oElim=new Button(oLstWin,e,t,"Eliminar","notGasElimClick()"),t+=130,oSalir=new Button(oLstWin,e,t,"Salir","oLstWin.release()"),oElim.disable(),oEditar.disable(),oLstWin.fadeIn()}else alert("No has hecho login")}function listNotGasClick(){oLstGrid.getFirstSelectedRow()<1?(oElim.disable(),oEditar.disable(),oAlta.enable()):(oElim.enable(),oEditar.enable(),oAlta.disable())}function notGasBuscClick(e){var t=oProy.getValue();t.length<1&&(t=" ");var o=oClase.getSelectedValue(),a=oAnno.getSelectedValue();if(e||" "!=t||" "!=a||" "!=o){var r=httpRequest(sRequestAdmnotgas,"LISTNOTGAS",sUsuario,t,o,a);if(!esUnError(r)){for(;1<oLstGrid.getRowCount();)oLstGrid.deleteRow(1);if(oElim.disable(),oEditar.disable(),oAlta.enable(),0<r.length&&""!=r[0].toString())for(i=0;i<r.length;i++)oLstGrid.addRow(r[i]),oLstGrid.setCellAlign(i+1,1,"right"),oLstGrid.setCellAlign(i+1,2,"right"),oLstGrid.setCellAlign(i+1,9,"right");else alert("No hay notas con esos datos")}}}function notGasElimClick(){var e=oLstGrid.getFirstSelectedRow();if(!(e<1)){var t=oLstGrid.getCell(e,1);if(confirm("¿Estás seguro de eliminar la Nota no. "+t+"?")){var o=httpRequest(sRequestAdmnotgas,"DELNOTGAS",sUsuario,t);esUnError(o)||(alert("Nota de Gastos eliminada con éxito"),notGasBuscClick(!1))}}}function mantCostes(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("TODO")<0)alert("Opción reservada para Dirección Financiera");else{gMCTieneSys=0<=aUsuRoles.indexOf("SYS"),oWin=new Form("Mantenimiento de Costes",940,370),oGrid=new Grid(oWin,30,5,930,240,["Sig","Nombre","Ext","Cat","Alta","Baja","SujSS","NoSS","Base Mx","PctSS","C.Dir","Roles"],910,!0,"mantCostesClick()");var e=285,t=20;Label(oWin,e,20,"Incluir bajas"),oBajas=new CheckBox(oWin,e,100,!1,"mantCostesGet()"),Label(oWin,e,150,"Sólo personas sin coste"),oNoCost=new CheckBox(oWin,e,300,!1,"mantCostesGet()"),e=320,t=20,130,oCostes=new Button(oWin,e,t,"Costes","costePersona('mantCostesGet')"),t+=130,oRoles=new Button(oWin,e,t,"Roles","rolPersona('mantCostesGet')"),t+=130,oSalir=new Button(oWin,e,t,"Salir","oWin.release()"),oCopy=new Image(oWin,e,840,"/img/copy.png",30,30,"copyGenerico(oGrid)"),oCopy.setTooltip("Copiar grid al clipboard"),oImpr=new Image(oWin,e,880,"/img/printer.png",30,30,"imprGenerico('COSTES', oGrid, 35)"),oImpr.setTooltip("Imprimir listado en PDF"),oCostes.disable(),oRoles.disable(),mantCostesGet(),oWin.fadeIn()}else alert("No has hecho login")}function mantCostesGet(){oCostes.disable(),oRoles.disable();var e=oBajas.isChecked()?"S":"N",t=oNoCost.isChecked()?"S":"N",o=httpRequest(sRequestAdmper,"LISTCOST",sUsuario,e,t);if(!esUnError(o)){for(;1<oGrid.getRowCount();)oGrid.deleteRow(1);for(i=0;i<o.length;i++)oGrid.addRow(o[i]),oGrid.setCellAlign(i+1,7,"right"),oGrid.setCellAlign(i+1,8,"right"),oGrid.setCellAlign(i+1,9,"right"),oGrid.setCellAlign(i+1,10,"right"),oGrid.setCellAlign(i+1,11,"right"),oGrid.setCellColor(i+1,11,"black","lightgray")}}function mantCostesClick(){0<oGrid.getFirstSelectedRow()?(oCostes.enable(),gMCTieneSys&&oRoles.enable()):(oCostes.disable(),oRoles.disable())}function mantGenerico(e,t,o){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0)alert("Opcion reservada para Administración");else{cMGTabla=e,aMGDefine=t,cMGClave=o,aMGCampos=[];for(var a=[],i=0;i<t.length;i++)aMGCampos[i]=t[i][0],a[i]=t[i][1];oMWin=new Form("Mantenimiento de "+e.toUpperCase(),890,370),oMGrid=new Grid(oMWin,30,5,880,270,a,860,!0,"mantGenericoClick()"),oMAdd=new Button(oMWin,320,160,"Agregar","mantGenericoEdit( true )"),oMEdit=new Button(oMWin,320,290,"Editar","mantGenericoEdit( false  )"),oMSupr=new Button(oMWin,320,420,"Eliminar","mantGenericoBaja()"),oMSalir=new Button(oMWin,320,550,"Salir","oMWin.release()"),oCopy=new Image(oMWin,320,790,"/img/copy.png",30,30,"copyGenerico(oMGrid)"),oCopy.setTooltip("Copiar grid al clipboard"),oImpr=new Image(oMWin,320,830,"/img/printer.png",30,30,"imprGenerico(cMGTabla, oMGrid)"),oImpr.setTooltip("Imprimir listado en PDF"),mantGenericoGet(),oMWin.fadeIn()}else alert("No has hecho login")}function mantGenericoGet(){soloPuedeVer()?oMAdd.disable():oMAdd.enable(),oMEdit.disable(),oMSupr.disable();var e="select "+aMGCampos.join(",")+" from "+cMGTabla+" order by "+cMGClave,t=httpRequest(sRequestDb,"DBSELECT",sUsuario,e);if(!esUnError(t)){for(;1<oMGrid.getRowCount();)oMGrid.deleteRow(1);for(var o=0;o<t.length;o++){oMGrid.addRow(t[o]);for(var a=0;a<aMGDefine.length;a++)"N"==aMGDefine[a][2]&&oMGrid.setCellAlign(o+1,a+1,"right")}}}function mantGenericoClick(){0<oMGrid.getSelectedRowCount()&&!soloPuedeVer()?(oMSupr.enable(),oMEdit.enable(),oMAdd.disable()):(oMSupr.disable(),oMEdit.disable(),soloPuedeVer()||oMAdd.enable())}function mantGenericoEdit(e){var t;if(badd=e,badd||!((t=getSeleccion(oMGrid))<0)){var o=120,a=50,i=[];cMGClave&&(i=cMGClave.split(",")),oEWin=new Form("Datos de "+cMGTabla.toUpperCase(),540,30*aMGDefine.length+130),aControl=[];for(var r=[],n=0;n<aMGCampos.length;n++){var s=!0;switch(Label(oEWin,a,25,aMGDefine[n][1]),aMGDefine[n][6]){case"-":aControl[n]=new TextBox(oEWin,a,o,"",!1),aControl[n].setWidth(char2pixel(aMGDefine[n][3]));break;case"U":aControl[n]=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),aControl[n].setWidth(char2pixel(aMGDefine[n][3]));break;case"A":aControl[n]=new TextBox(oEWin,a,o,"",!1),aControl[n].setWidth(char2pixel(aMGDefine[n][3])),aControl[n].disable(),!badd&&-1!=i.indexOf(aMGDefine[n][0])||(r[n]=new Button(oEWin,a,o+char2pixel(aMGDefine[n][3])+10,"?","ayudaGenerico(this)",20,20),r[n].setName("hlp"+n));break;case"C":aControl[n]=new CheckBox(oEWin,a,o,!1),s=!1;break;case"L":s=!1;var l=aMGDefine[n][7].split(":");if(2==l.length){var d=l[0].split(","),c=l[1].split(",");aControl[n]=new ComboBox(oEWin,a,o,d,c,0)}else aControl[n]=new Label(oEWin,a,o,"Mal definido!!");break;default:aControl[n]=new Label(oEWin,a,o,"Mal definido!!"),s=!1}if(s)if("N"==aMGDefine[n][2]){var u=aMGDefine[n][3],m=aMGDefine[n][4];0<m&&(u=u-m-1),aControl[n].setNumericMask(u,m,",","",!1,!0,"")}else"D"==aMGDefine[n][2]&&(aControl[n].setDateMask("dd/MM/yyyy"),aControl[n].setWidth(10*nPixelPerChar));!badd&&-1<i.indexOf(aMGDefine[n][0])&&aControl[n].disable(),a+=30}if(a+=10,oEGuardar=new Button(oEWin,a,150,"Guardar","mantGenericoGuardar(badd, aControl)"),oESalir=new Button(oEWin,a,280,"Salir","oEWin.release()"),a+=40,oEStatus=new Label(oEWin,a,25,badd?"Entre datos del nuevo registro":"Actualice datos del registro","red"),badd)aControl[0].setFocus();else for(n=0;n<aMGDefine.length;n++){var g=oMGrid.getCell(t,n+1);aControl[n]instanceof ComboBox?aControl[n].setIndexByValue(g):aControl[n].setValue(g)}oEWin.fadeIn()}}function mantGenericoGuardar(e,t){for(var o=[],a=[],i=[],r=0;r<aMGDefine.length;r++)if(o[r]=aMGDefine[r][0],i[r]="C",t[r]instanceof TextBox){var n=!1,s=t[r].getValue();if("N"==aMGDefine[r][2]?(a[r]=strToNumberSpain(s),0==a[r]&&(n=!0),0==aMGDefine[r][4]?i[r]="I":i[r]="N"):"D"==aMGDefine[r][2]?(a[r]=fecha2js(s),"  /  /    "==s&&(n=!0),i[r]="D"):(a[r]=trim(s),""===a[r]&&(n=!0)),"S"==aMGDefine[r][5]&&n)return void alert("El campo '"+aMGDefine[r][1]+"' es obligatorio")}else t[r]instanceof CheckBox?a[r]=t[r].getValue():t[r]instanceof ComboBox&&(a[r]=t[r].getSelectedValue());var l=mantGenericoExiste(a);if(!(l<0)){var d;if(e){if(0<l)return void alert("Ya existe un registro con esa clave");d=httpRequest(sRequestDb,"DBINSERT",sUsuario,cMGTabla,o,a,i)}else{if(0==l)return void alert("No existe ningun registro con esa clave");var c="",u=cMGClave.split(",");for(r=0;r<u.length;r++){var m=aMGCampos.indexOf(u[r]);-1<m&&(0<c.length&&(c+=" and "),c+=u[r]+"=","number"==typeof a[m]?c+=a[m]:c+="'"+a[m]+"'")}d=httpRequest(sRequestDb,"DBUPDATE",sUsuario,cMGTabla,o,a,c,i)}esUnError(d)||(alert("Procesados "+d[0].toString()+" registros"),mantGenericoGet(),oEWin.release())}}function mantGenericoBaja(){var e=getSeleccion(oMGrid);if(!(e<1)&&confirm("¿Estás absolutamente seguro de eliminar este registro?\nPor favor confirma")){for(var t=cMGClave.split(","),o=[],a=[],i=0;i<t.length;i++){var r=aMGCampos.indexOf(t[i]);if(r<0)return void alert("Hay una inconsistencia en la definición de campos");o[i]=oMGrid.getCell(e,r+1),a[i]="C","N"==aMGDefine[r][2]?(o[i]=strToNumberSpain(o[i]),0==aMGDefine[r][4]?a[i]="I":aTipo[i]="N"):"D"==aMGDefine[r][2]&&(o[i]=fecha2js(o[i]),a[i]="D")}var n=httpRequest(sRequestDb,"DBDELETE",sUsuario,cMGTabla,t,o,a);esUnError(n)||(alert("Se ha eliminado "+n[0]+" registro"),mantGenericoGet())}}function mantGenericoExiste(e){for(var t=cMGClave.split(","),o=[],a=[],i=0;i<t.length;i++){var r=aMGCampos.indexOf(t[i]);r<0?(o[i]="NULL",a[i]="C"):(o[i]=e[r],a[i]=aMGDefine[r][2])}var n=httpRequest(sRequestDb,"DBEXISTS",sUsuario,cMGTabla,t,o,a);return esUnError(n)?-1:parseInt(n[0])}function mantPer(){if(0!=bLoggedIn)if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0)alert("Opción reservada para Administración");else{gMPTieneTodo=0<=aUsuRoles.indexOf("TODO"),oWin=new Form("Mantenimiento de Personas",940,370),oGrid=new Grid(oWin,30,5,930,240,["Sig","Nombre","Sup","Ext","Cat","Calend","Alta","Baja","V.Año","V.Ant","Correo"],910,!0,"mantPerClick()");var e=285,t=20;Label(oWin,e,20,"Incluir bajas"),oBajas=new CheckBox(oWin,e,100,!1,"mantPerGet()"),Label(oWin,e,150,"Sólo personas sin coste"),oNoCost=new CheckBox(oWin,e,300,!1,"mantPerGet()"),e=320,t=20,130,oAdd=new Button(oWin,e,t,"Agregar","mantPerEditar( true )"),t+=130,oChgPwd=new Button(oWin,e,t,"Cambiar Pwd","mantPerChangePwd()"),t+=130,oBaja=new Button(oWin,e,t,"Dar de baja","mantPerBaja( false )"),t+=130,oEdit=new Button(oWin,e,t,"Editar","mantPerEditar( false  )"),t+=130,oSupr=new Button(oWin,e,t,"Eliminar","mantPerBaja( true )"),t+=130,oSalir=new Button(oWin,e,t,"Salir","oWin.release()"),oCopy=new Image(oWin,e,840,"/img/copy.png",30,30,"copyGenerico(oGrid)"),oCopy.setTooltip("Copiar grid al clipboard"),oImpr=new Image(oWin,e,880,"/img/printer.png",30,30,"imprGenerico('personas', oGrid, 35)"),oImpr.setTooltip("Imprimir listado en PDF"),mantPerGet(),oWin.fadeIn()}else alert("No has hecho login")}function mantPerGet(){oEdit.disable(),oBaja.disable(),oSupr.disable(),oChgPwd.disable(),soloPuedeVer()?oAdd.disable():oAdd.enable();var e=oBajas.isChecked()?"S":"N",t=oNoCost.isChecked()?"S":"N",o=httpRequest(sRequestAdmper,"LISTPER",sUsuario,e,t);if(!esUnError(o)){for(;1<oGrid.getRowCount();)oGrid.deleteRow(1);for(i=0;i<o.length;i++)oGrid.addRow(o[i]),oGrid.setCellAlign(i+1,9,"right"),oGrid.setCellAlign(i+1,10,"right")}}function mantPerClick(){0<oGrid.getSelectedRowCount()&&!soloPuedeVer()?(oBaja.enable(),oEdit.enable(),oChgPwd.enable(),gMPTieneTodo&&oSupr.enable(),oAdd.disable()):(oBaja.disable(),oSupr.disable(),oEdit.disable(),oChgPwd.disable(),soloPuedeVer()||oAdd.enable())}function mantPerBaja(e){var t=getSeleccion(oGrid);if(!(t<0)){if(e){if(!gMPTieneTodo)return void alert("Opción reservada a Dirección Financiera");if(!confirm("Si eliminas a "+oGrid.getCell(t,2)+"\ntodos sus datos, incluyendo sus partes, se perderán.\n¿Estás completamente seguro de continuar?"))return}else if(!confirm("¿Estás seguro de dar de baja a "+oGrid.getCell(t,2)+"\ncon fecha efectiva de hoy?"))return;var o=e?"S":"N",a=httpRequest(sRequestAdmper,"BAJAPER",sUsuario,oGrid.getCell(t,1),o);esUnError(a)||mantPerGet()}}function mantPerEditar(e){var t;if(badd=e,badd||!((t=getSeleccion(oGrid))<0)){var o=120,a=50;oEWin=new Form("Datos de la Persona",450,490),Label(oEWin,a,25,"Siglas"),oESig=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oESig.setWidth(50),a+=30,Label(oEWin,a,25,"Nombre"),oENombre=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oENombre.setWidth(300),a+=30,Label(oEWin,a,25,"Depende de"),oEJefe=new TextBox(oEWin,a,o,"",!1,"ayudaSimpleOnChange(this, true)"),oEJefe.setWidth(50),oEJefeHelp=new Button(oEWin,a,180,"?","ayudaSimple(this)",20,22),prepararAyudaSimple(oEJefe,oEJefeHelp,null,"Recursos:Siglas:Nombre:baja is null"),a+=30,Label(oEWin,a,25,"Externo"),oEExterno=new CheckBox(oEWin,a,o,!1),a+=30,Label(oEWin,a,25,"Categoria"),oECateg=new TextBox(oEWin,a,o,""),oECateg.setWidth(60),oECateg.disable(),oECategHelp=new Button(oEWin,a,190,"?","ayudaCateg(oECateg)",20,20),a+=30,Label(oEWin,a,25,"Calendario"),oECalend=new TextBox(oEWin,a,o,""),oECalend.setWidth(60),oECalend.disable(),oECalendHelp=new Button(oEWin,a,190,"?","ayudaCalend(oECalend)",20,20),a+=30,Label(oEWin,a,25,"Fecha Alta"),oEAlta=new DatePicker(oEWin,a,o,""),a+=30,Label(oEWin,a,25,"Fecha Baja"),oEBaja=new DatePicker(oEWin,a,o,""),oEClearBaja=new Button(oEWin,a,270,"Cancelar baja","oEBaja.setValue('')","",22),a+=30,Label(oEWin,a,25,"Vacs. Año"),oEVacAnno=new TextBox(oEWin,a,o,""),oEVacAnno.setWidth(50),a+=30,Label(oEWin,a,25,"Vacs. Ant"),oEVacAnt=new TextBox(oEWin,a,o,""),oEVacAnt.setWidth(50),oEVacAnt.disable(),a+=30,Label(oEWin,a,25,"eMail"),oECorreo=new TextBox(oEWin,a,o,""),oECorreo.setWidth(300),a+=50,oEGuardar=new Button(oEWin,a,100,"Guardar","mantPerGuardar(badd)"),oESalir=new Button(oEWin,a,230,"Salir","oEWin.release()"),a+=50,oEStatus=new Label(oEWin,a,25,"Entre datos de la persona","red"),badd?oESig.setFocus():(oESig.setValue(trim(oGrid.getCell(t,1))),oESig.disable(),oENombre.setValue(trim(oGrid.getCell(t,2))),oEJefe.setValue(trim(oGrid.getCell(t,3))),"S"==oGrid.getCell(t,4)?oEExterno.check():oEExterno.unCheck(),oECateg.setValue(trim(oGrid.getCell(t,5))),oECalend.setValue(trim(oGrid.getCell(t,6))),oEAlta.setValue(fecha2js(oGrid.getCell(t,7))),oEBaja.setValue(fecha2js(oGrid.getCell(t,8))),oEVacAnno.setValue(oGrid.getCell(t,9)),oEVacAnt.setValue(oGrid.getCell(t,10)),oECorreo.setValue(trim(oGrid.getCell(t,11))),oENombre.setFocus()),oEWin.fadeIn()}}function mantPerGuardar(e){var t;if(e&&3!=oESig.getValue().length)return oEStatus.setValue("Las siglas deben tener 3 caracteres"),void oESig.setFocus();if(trim(oENombre.getValue()).length<1)return oEStatus.setValue("El nombre es obligatorio"),void oENombre.setFocus();if(trim(oECateg.getValue()).length<1)oEStatus.setValue("La categoria es obligatoria");else{if("*"==trim(oECateg.getValue()))return oEStatus.setValue("La categoria no admite comodín en esta tabla"),void reproducir("chord.wav");if(trim(oECalend.getValue()).length<1)oEStatus.setValue("El calendario es obligatorio");else{if(oEAlta.getValue().length<1)return oEStatus.setValue("La fecha de Alta es obligatoria"),void oEAlta.setFocus();if(e&&1<(t=httpRequest(sRequest,"GETUSR",sUsuario,oESig.getValue())).length)return oEStatus.setValue("Las siglas ya existen"),void oESig.setFocus();var o=trim(oEJefe.getValue());if(0<o.length){if(3!=o.length)return oEStatus.setValue('"Depende de" vacío o 3 caracteres'),void oEJefe.setFocus();if((t=httpRequest(sRequest,"GETUSR",sUsuario,o)).length<2)return oEStatus.setValue('"Depende de" no existe'),void oEJefe.setFocus()}var a=[trim(oESig.getValue()),trim(oENombre.getValue()),trim(oEJefe.getValue()),oEExterno.isChecked()?"S":"N",trim(oECateg.getValue()),trim(oECalend.getValue()),js2fecha(oEAlta.getValue()),js2fecha(oEBaja.getValue()),oEVacAnno.getValue(),oEVacAnt.getValue(),trim(oECorreo.getValue())];t=httpRequest(sRequestAdmper,"UPDPER",sUsuario,e?"S":"N",a),esUnError(t)||(alert("Usuario "+a[0]+" actualizado con éxito"),mantPerGet(),oEWin.release())}}}function mantPerChangePwd(){var e=oGrid.getFirstSelectedRow();if(!(e<1)){var t=oGrid.getCell(e,1);cambiarPasswd(t)}}function mantTrab(){0!=bLoggedIn?aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0?alert("Opción reservada para Administración"):(gMTTieneTodo=0<=aUsuRoles.indexOf("TODO"),oWin=new Form("Mantenimiento de Códigos de Trabajo",890,390),oGrid=new Grid(oWin,30,5,880,240,["Trab","Descripción","Unid","Est","Tarifa","Area","Division"],860,!0,"mantTrabClick()"),Label(oWin,300,20,"Proyecto"),oProy=new TextBox(oWin,300,100,"",!1,"mantTrabGet()","proy"),oProy.setWidth(40),oProy.disable(),oProyHelp=new Button(oWin,300,150,"?","ayudaProy(this)",20,20),oProyDesc=new Label(oWin,300,180,"","","","proyDesc"),oAdd=new Button(oWin,340,20,"Alta","mantTrabEditar( true )"),oEdit=new Button(oWin,340,150,"Editar","mantTrabEditar( false  )"),oSupr=new Button(oWin,340,280,"Eliminar","mantTrabBaja()"),oSalir=new Button(oWin,340,410,"Salir","oWin.release()"),oCopy=new Image(oWin,340,800,"/img/copy.png",30,30,"copyGenerico(oGrid)"),oImpr=new Image(oWin,340,840,"/img/printer.png",30,30,"imprGenerico('OOTT', oGrid, 30)"),oAdd.disable(),oEdit.disable(),oSupr.disable(),oWin.fadeIn()):alert("No has hecho login")}function mantTrabGet(){oAdd.disable(),oEdit.disable(),oSupr.disable(),soloPuedeVer()||oAdd.enable();var e=oProy.getValue();if(!(trim(e).length<1)){e=e.toUpperCase(),oProy.setValue(e);var t=chkProyecto(e);if(esUnError(t))oProyDesc.setValue("");else if(oProyDesc.setValue(t[0]),t=httpRequest(sRequestAdmtrab,"LISTTRAB",sUsuario,e),!esUnError(t)){for(;1<oGrid.getRowCount();)oGrid.deleteRow(1);for(i=0;i<t.length;i++)oGrid.addRow(t[i])}}}function mantTrabClick(){0<oGrid.getSelectedRowCount()&&!soloPuedeVer()?(oAdd.disable(),gMTTieneTodo&&oSupr.enable(),oEdit.enable()):(oSupr.disable(),oEdit.disable(),soloPuedeVer()||oAdd.enable())}function mantTrabBaja(){var e=getSeleccion(oGrid);if(!(e<0)&&confirm("Si eliminas el trabajo "+oGrid.getCell(e,2)+"\nes posible que se produzcan inconsistencias en la BD.\n¿Estás completamente seguro de continuar?")){var t=httpRequest(sRequestAdmtrab,"BAJATRAB",sUsuario,oProy.getValue(),oGrid.getCell(e,1));esUnError(t)||mantTrabGet()}}function mantTrabEditar(e){var t;if(badd=e,badd||!((t=getSeleccion(oGrid))<0)){var o=120,a=50;oEWin=new Form("Datos del Código de Trabajo",450,370),Label(oEWin,a,25,"Código"),oETrab=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oETrab.setWidth(30),a+=30,Label(oEWin,a,25,"Descripción"),oEDesc=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oEDesc.setWidth(300),a+=30,Label(oEWin,a,25,"Unidades"),oEUnid=new ComboBox(oEWin,a,o,["H - Horas normales","S - Semanas guardia no presencial","G - Dias guardia no presencial","D - Dias disponibilidad presencial","P - Horas disponbilidad presencial"],["H","S","G","D","P"],0),a+=30,Label(oEWin,a,25,"Estado"),oEEst=new ComboBox(oEWin,a,o,["Abierto","Cerrado","Bloqueado"],["A","C","B"],0),a+=30,Label(oEWin,a,25,"Tarifa"),oETarif=new ComboBox(oEWin,a,o,[],[],0),a+=30,Label(oEWin,a,25,"Area"),oEArea=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oEArea.setWidth(50),a+=30,Label(oEWin,a,25,"Division"),oEDivis=new TextBox(oEWin,a,o,"",!1,"forzarMayusculas(this)"),oEDivis.setWidth(50),a+=50,oEGuardar=new Button(oEWin,a,100,"Guardar","mantTrabGuardar(badd)"),oESalir=new Button(oEWin,a,230,"Salir","oEWin.release()"),a+=50,oEStatus=new Label(oEWin,a,25,"Entre datos del codigo de trabajo","red"),mantTrabFillTarif(),badd?oETrab.setFocus():(oETrab.setValue(trim(oGrid.getCell(t,1))),oETrab.disable(),oEDesc.setValue(trim(oGrid.getCell(t,2))),oEUnid.setIndexByValue(oGrid.getCell(t,3)),oEEst.setIndexByValue(oGrid.getCell(t,4)),oETarif.setIndexByValue(trim(oGrid.getCell(t,5))),oEArea.setValue(trim(oGrid.getCell(t,6))),oEDivis.setValue(trim(oGrid.getCell(t,7))),oEDesc.setFocus()),oEWin.fadeIn()}}function mantTrabFillTarif(){var e=httpRequest(sRequest,"HLPTARIF",sUsuario);if(!esUnError(e))for(var t=0;t<e.length;t++)oETarif.addOption(trim(e[t]),trim(e[t]))}function mantTrabGuardar(e){var t,o=[];return e&&3!=oETrab.getValue().length?(oEStatus.setValue("El codigo debe tener 3 caracteres"),void oETrab.setFocus()):trim(oEDesc.getValue()).length<1?(oEStatus.setValue("La descripción es obligatoria"),void oEDesc.setFocus()):(o[0]=oProy.getValue(),o[1]=oETrab.getValue(),o[2]=trim(oEDesc.getValue()),o[3]=oEUnid.getSelectedValue(),o[4]=oEEst.getSelectedValue(),o[5]=oETarif.getSelectedValue(),o[6]=trim(oEArea.getValue()),o[7]=trim(oEDivis.getValue()),t=httpRequest(sRequestAdmtrab,"UPDTRAB",sUsuario,e?"S":"N",o),void(esUnError(t)||(alert("Trabajo "+o[0]+o[1]+" actualizado con éxito"),mantTrabGet(),oEWin.release())))}function mantProy(){mantGenerico("proyecto",[["codigo","Código","C",3,0,"S","U",""],["descrip","Nombre","C",40,0,"S","-",""],["direccion","Dirección","C",40,0,"N","-",""],["sedirec","2ª Dir","C",23,0,"N","-",""],["cpostal","C.Postal","C",5,0,"N","-",""],["ciudad","Ciudad","C",30,0,"N","-",""],["atencion","A/A","C",35,0,"N","-",""],["cif","CIF","C",14,0,"N","U",""],["cuenta","Est","C",1,0,"S","L","Abierto,Cerrado: A,C"],["responsab","Resp","C",4,0,"N","A","recursos:siglas:nombre:baja is null"]],"codigo")}function mantTarif(){mantGenerico("tarifas",[["tarifa","Tarifa","C",4,0,"S","U",""],["categoria","Categoría","C",4,0,"S","A","categorias:categoria:descrip:N"],["precio","Precio","N",7,2,"N","-",""],["unidades","Unidades","C",8,0,"N","-",""]],"tarifa,categoria")}function mantCateg(){mantGenerico("categorias",[["categoria","Categoría","C",4,0,"S","U",""],["descrip","Descripción","C",40,0,"S","-",""]],"categoria")}function mantCalend(){mantGenerico("calendar",[["anno","Año","N",4,0,"S","-",""],["codigo","Calendario","C",5,0,"S","U",""],["inijv","Inicio j. verano","D",10,0,"N","-",""],["finjv","Fin j. verano","D",10,0,"N","-",""],["ilunjue","Lun-jue (inv)","N",5,2,"S","-",""],["ivie","Viernes (inv)","N",5,2,"S","-",""],["vlunjue","Lun-jue (ver)","N",5,2,"S","-",""],["vvie","Viernes (ver)","N",5,2,"S","-",""],["numvac","Vacaciones","N",2,0,"N","-",""]],"anno,codigo")}function mantFestiv(){mantGenerico("festivos",[["anno","Año","N",4,0,"S","-",""],["mes","Mes","N",4,0,"S","-",""],["dia","Dia","N",4,0,"S","-",""],["notas","Notas","C",20,0,"N","-",""]],"anno,mes,dia")}function mantProveed(){mantGenerico("proveedor",[["codigo","Código","C",16,0,"S","U",""],["nombre","Nombre","C",40,0,"N","-",""],["iban","Iban","C",34,0,"N","-",""],["direccion","Dirección","C",40,0,"N","-",""],["ciudad","Ciudad","C",30,0,"N","-",""],["cp","C. Postal","C",10,0,"N","-",""],["pais","País","C",30,0,"N","-",""],["clasif","Clasificación","C",30,0,"N","-",""]],"codigo")}function mantTaresp(){mantGenerico("taresp",[["siglas","Siglas","C",3,0,"S","A","recursos:siglas:nombre:baja is null"],["proyecto","Proyecto","C",3,0,"S","A","proyecto:codigo:descrip:N"],["trabajo","Trabajo","C",3,0,"S","A","codtrab:trabajo:descrip:proyecto=@1"],["tarifa","Tarifa","N",9,2,"S","-",""],["unidades","Unidades","C",8,0,"N","-",""]],"siglas,proyecto,trabajo")}function mantTipdoc(){mantGenerico("tipos",[["tipo","Tipo","C",2,0,"S","U",""],["descrip","Descripción","C",30,0,"S","-",""]],"tipo")}function soloPuedeVer(){return aUsuRoles.indexOf("ADMON")<0&&0<=aUsuRoles.indexOf("VIEW")}function tieneTodo(){return 0<=aUsuRoles.indexOf("TODO")}function numFichRH(){0!=bLoggedIn?aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0?alert("Opcion reservada para Administracion"):(oNFWin=new Form("Resumen Fichajes",530,290),oNFGrid=new Grid(oNFWin,30,5,520,170,["Siglas","Nombre","Num. Fichajes"],500,!0,"numFichRHClick()"),Label(oNFWin,210,100,"Año"),oNFAnno=new ComboBox(oNFWin,210,130,["2019","2020","2021","2022"],["2019","2020","2021","2022"],0),ponAnnoActual(oNFAnno),Label(oNFWin,210,200,"Mes"),oNFMes=new ComboBox(oNFWin,210,235,["-----","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],["0","1","2","3","4","5","6","7","8","9","10","11","12"],0),Label(oNFWin,210,388,"Por número"),oNFSort=new CheckBox(oNFWin,210,465,!1,"numFichRHBusc()"),oNFBusc=new Button(oNFWin,250,10,"Buscar","numFichRHBusc()"),oNFSel=new Button(oNFWin,250,140,"Detalle","numFichRHSelect()"),oNFSel.disable(),oNFImp=new Button(oNFWin,250,270,"Imprimir","numFichRHImp()"),oNFImp.disable(),Button(oNFWin,250,400,"Salir","oNFWin.release()"),oNFWin.fadeIn()):alert("No has hecho login")}function numFichRHClick(){0<oNFGrid.getSelectedRowCount()?oNFSel.enable():oNFSel.disable()}function numFichRHBusc(){var a=oNFAnno.getSelectedValue(),i=oNFMes.getSelectedValue(),r=oNFSort.isChecked()?"N":"S";oNFSel.disable(),oNFImp.disable(),trabajando(!0),setTimeout(function(){var e=httpRequest(sRequestReghor,"NUMFICH",sUsuario,a,i,r);if(trabajando(!1),!esUnError(e)){for(;1<oNFGrid.getRowCount();)oNFGrid.deleteRow(1);var t=e.length;if(""==e[0]&&(t=0),0<t){for(var o=0;o<t;o++)oNFGrid.addRow(e[o],!1),oNFGrid.setCellAlign(o+1,3,"right");oNFImp.enable()}}},50)}function numFichRHSelect(){var e=oNFGrid.getFirstSelectedRow();if(!(e<1))if("0"!=oNFMes.getSelectedValue()){var t=oNFAnno.getSelectedValue(),o=oNFMes.getSelectedValue(),a=oNFGrid.getCell(e,1);listMesRH(!0,a,t,o)}else alert("Es necesario seleccionar un mes para ver el detalle")}function numFichRHImp(){var e=oNFAnno.getSelectedValue(),t=oNFMes.getSelectedValue();auxNumFichRHImp(e,t,oNFGrid)}function pdtesFacturar(e,t,o){0!=bLoggedIn?aUsuRoles.indexOf("ADMON")<0?alert("Opcion reservada para Administración"):(gPdtesFacRefresh=e,gPdtesFacProy=t,gPdtesFacTrab=o,oMWin=new Form("Líneas pendientes de factuar",600,370),oMGrid=new Grid(oMWin,30,5,580,270,["Proy","Trab","Año","Mes","Descripción","Importe"],560,!0,"pdtesFacturarClick()"),oMFact=new Button(oMWin,320,40,"Facturar","pdtesFacturarFact()"),oMSalir=new Button(oMWin,320,170,"Salir","pdtesFacturarSalir()"),oCopy=new Image(oMWin,320,500,"/img/copy.png",30,30,"copyGenerico(oMGrid)"),oCopy.setTooltip("Copiar grid al clipboard"),oImpr=new Image(oMWin,320,540,"/img/printer.png",30,30,"imprGenerico('Pendientes Facturar', oMGrid)"),oImpr.setTooltip("Imprimir listado en PDF"),pdtesFacturarGet(!1)):alert("No has hecho login")}function pdtesFacturarSalir(){gPdtesFacRefresh&&new Function(gPdtesFacRefresh+"(true)")(!0);oMWin.release()}function pdtesFacturarGet(e){var t=httpRequest(sRequestFacemi,"PDTESFAC",sUsuario,gPdtesFacProy,gPdtesFacTrab);if(esUnError(t))e||oMWin.release();else{for(;1<oMGrid.getRowCount();)oMGrid.deleteRow(1);if(0<t.length&&0<t[0].toString().length)for(var o=0;o<t.length;o++)oMGrid.addRow(t[o]),oMGrid.setCellAlign(o+1,3,"right"),oMGrid.setCellAlign(o+1,4,"right"),oMGrid.setCellAlign(o+1,6,"right");oMFact.disable()}}function pdtesFacturarClick(){oMGrid.getFirstSelectedRow()<1?oMFact.disable():oMFact.enable()}function pdtesFacturarFact(){var e=oMGrid.getFirstSelectedRow();e<1||detFacEmi("P","pdtesFacturarGet",oMGrid.getCell(e,1),oMGrid.getCell(e,2),"",oMGrid.getCell(e,3),oMGrid.getCell(e,4))}function printFacEmiPDF(e){if(bInternetExplorer)alert("IExplorer no soporta la impresión en PDF");else{if("A"==gDetFacEmiAccion){if(oDetGrid.getSelectedRowCount()<1)return void alert("No has seleccionado ninguna línea para imprimir")}else if(oDetGrid.getRowCount()<2)return void alert("La factura no tiene líneas");var t=httpRequest(sRequest,"GETPROY",sUsuario,oDetProy.getValue());if(!esUnError(t)){var o=new jsPDF("p","mm","a4"),a="helvetica";o.addImage(dameLogo(),"png",18,18,50,15),o.setFont(a,"normal"),o.setFontSize(8),o.setTextColor(120,122,195),o.text("Número de cuenta de abono: "+cCuentaBanco,110,275,"center"),o.text("Entidad: "+cNombreBanco,110,279,"center"),o.text("Comunytek Consultores, S.L. C/ Claudio Coello, 79, 1º 28001 Madrid. Tlf 914260143. RM Madrid T17.712 LO F89 S8 Hoja M-305995 I1. CIF B83317008",18,245,null,90),o.setTextColor(0,0,0),o.text("Visado Comunytek",45,247),o.text("Vº Bº Cliente",92,247),o.rect(37,249,37,13),o.rect(80,249,37,13),"A"!=gDetFacEmiAccion||e?"C"==oDetEstad.getSelectedValue()&&(o.setTextColor(255,221,189),o.setFontSize(80),o.text("COBRADA",70,180,null,45),o.setTextColor(0)):(o.setTextColor(220,220,220),o.setFontSize(80),o.text("BORRADOR",60,180,null,45),o.setTextColor(0)),o.setFontSize(11),o.rect(90,40,100,30),o.text(t[0],93,46),o.text(t[1],93,51),o.text(t[2],93,56),o.text(t[3]+" "+t[4],93,61),o.text("A/A: "+t[5],93,66);var i,r=strToNumberSpain(oDetNeto.getValue()),n=oDetProy.getValue()+" "+oDetTrab.getValue()+" ";"A"!=gDetFacEmiAccion||e?(i=0<=r?"Factura Número":"Abono Número",n+=oDetNum.getValue()):(i="Borrador trabajo",n+="XXX"),o.setProperties({title:"Factura "+n});o.text(i,40,85),o.setFont(a,"bold"),o.text(n,77,85),o.setFont(a,"normal"),o.text("Fecha Emisión",40,90),o.text(js2fecha(oDetFemi.getValue()),77,90),o.text("Vencimiento",40,95),o.text(js2fecha(oDetFvto.getValue()),77,95),o.text("CIF Cliente",40,100),o.text(t[6],77,100),o.setDrawColor(0),o.setFillColor(120,120,120),o.rect(40,105,135,7,"F"),o.setDrawColor(0,0,0),o.setFillColor(0,0,0),o.setTextColor(255,255,255),o.setFont(a,"bold"),o.text("Item",45,110),o.text("Descripción",85,110),o.text("Importe",153,110),o.setTextColor(0,0,0),o.setFont(a,"normal");for(var s,l=0,d=118,c=0,u=parseFloat(oDetIva.getValue()),m=oDetGrid.getRowCount(),g=1;g<m;g++)if("A"!=gDetFacEmiAccion||oDetGrid.isSelected(g)){var b;for(l++,o.text(l.toString(),45,d),b=oDetGrid.getCell(g,2).replaceAll("&amp;","&").split("<br>");b[b.length-1].trim().length<1;)b.pop();for(var D=0;D<b.length;D++)o.text(b[D],58,d),D==b.length-1&&(0==r?o.text("N/A",170,d,"right"):o.text(oDetGrid.getCell(g,3),170,d,"right"),c+=strToNumberSpain(oDetGrid.getCell(g,3)),d+=3),d+=5}s=c*u/100,0==r&&(c=0),o.rect(40,105,135,d-110),o.line(40,112,175,112),o.setDrawColor(0),o.setFillColor(168,207,255),o.rect(105,d-3,70,23,"F"),o.setDrawColor(0,0,0),o.setFillColor(0,0,0),d+=3,o.text("Total",110,d),o.text(numberToStrSpain(c,2,!0),170,d,"right"),d+=5,o.text("IVA ("+u.toString()+"%)",110,d),o.text(numberToStrSpain(s,2,!0),170,d,"right"),d+=8,o.setFont(a,"bold"),o.text("Total Factura €",110,d),o.text(numberToStrSpain(c+s,2,!0),170,d,"right"),o.setFontSize(24),o.setTextColor(170,170,170),o.text(n,125,261),renderPdf(o,"Factura "+n)}}}function renderPdf(e,t){var o="<html><head><title>"+t+"</title></head><embed width='100%' height='100%' src='"+e.output("datauristring")+"'/>",a=window.open();a?(a.document.write(o),a.document.close()):alert("No se ha podido abrir la nueva ventana")}function dameLogo(){return"iVBORw0KGgoAAAANSUhEUgAAAXAAAABqCAYAAAClIwp2AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAGYktHRAD/AP8A/6C9p5MAAAAHdElNRQfhCgsKMRhU2+cVAAArVUlEQVR4Xu2dB5gURRaAC9hlyWnJOWeUZMCAeuopxjMrmHMOGDFhjqggiGI8PfUM553hzHpmBck5LjnvLpllSevVX9O9O9tT1dM9O7swa/188213M6G7wqtXr957VeEPiSgHLFq/Q6zesksk+2EqyFf9ammiQ2blyAWLxWLZSygXAvzWL1eJHxZvTbrwdkGId26QId44tUXkgsVisewFVHT+piQI7Du+Xi2+L0XhDXz37Ozt4oqPV0QuWCwWy15ASgvwnbv/EN8t2uKclT6TVm0TOXm7nDOLxWLZs6S0AJ+5Nl8UlLEB6IsFZTdgWCwWix8pLcC3Sw28rNm6o8A5slgslj1LSgtwi8Vi+TNjBbjFYrGkKFaAWywWS4piBbjFYrGkKFaAWywWS4piBbjFYrGkKFaAWywWS4piBbjFYrGkKFoBnr/rD7F9L3/tLJAvJ5CHZFN+L4vFYimPFGYj3C0F4mM/ZYsP52xS/5EKdKqfId48LViGwHdmbBCjxuUq4V8SLu1TT1zRt55zZrFYLHsOpYEj0o5/a3FKCW+oFEK9Prt7HfHpoNYis1ol54rFYrGkNkqAX/nxCpGbt1tdKM/UrlJJDO7XwDmzWCyW1KbixvzdYsrqbc5p+eev7Ws4RxaLxZLaVMzbWSDKx6ZqFovF8ufCuhFaLBZLimIFuMVisaQoVoBbLBZLimIFuMVisaQoVoBbLBZLipLSAnzHHtgTs0qaDc63WCx7ByktwBdt2Fnmu9L3b1XdObJYLJY9S0oLcPK3jF2e55yVPm3rVhZt5MtisVj2BlLeBn7jZyvFN1lbnLPSo3P9DDH6hGbOmcVisex5KqzctOOPk99eohJapTItaqeLv7arKepUqej7LBUrVBAz1+aLtIrxbdl8T/X0CuKQVtXFgc2rRS5aLBbLXkK5EeBh+OHitqJaunXAsVgsqY2VYhaLxZKiWAFusVgsKYoV4BaLxZKiWAFusVgsKYoV4BaLxZJktm3LF1u35sW8du3a5bwjOVgvFIvFYkkyg2+5XSxZukxUqFDkrsz+8Tdcd7Xof+ghzpWSY6XYHmDL1q0iJydHrFq1WqzNzhabN5d+IJLFYik73F3OENruqzSwGngps3v3bjmd2ia++/5H8cOPP4lFi5c4/xNLixbNxWFydD76qL+IqlWrikqV7A76FksqctPNt4uly5Y5Z0UkWwO3AryUQHC/8ebb4vfxE8TatdnO1eA0bNBA9OnTS1x0wXlWkFssKYYV4KVIaQpwFik+/+Ir8fc33nSulJyB55wljh9wjKhSpYpzxWIp34wY+Zxa9Itmx86d4vprrhT16tVzruy9lJUAtzbwJLJy1Sox6PyLkyq84e1/vivOu/BSkZW10LlisZRvpkydLiZOmlzsNX36DJG/fbvzDgtYAZ4kPvzoE3H9jbck3U3IpaCgQNw25G6xcuUq54rFYvmzYwV4Evjk08/EP976Z6CVZmzbnTp1FAcesJ844vD+cjp1sOjerato3qyZSEtLc95lBru6xWKxgBXgJeQ/H34s/v56fJPJscccLd5641UxetRw8fADQ8WtN98krr36SnHDddeI+4feLYY//YR4+x+viSsvv9R30ZLFUYvFYgErwEtA1sJF4s2333HOiuM68J94wnHitVfGiMsuuUgtQnI92rnfhWsIblwI33nrdSXYdRr5oIFnOUcWi+XPjvVCSZDt27erBUuT2QThe+P114h+Bx7gXAkPv3H/Q4+K1atXq+877thjxN9OPtH53+CgtW/eskXk5+cX2ugrVawkMjIqi+rVq8u/GepaImyR34t9PhqKpEaN6saZRF5eJKx4x44dst39ISpWqKjuoVatmiI9Pd15V3Cog42bNon8bfL5dsvnk7+flp4mqlWrJmrVrOm8KxiUOS8vlD/fFxbubdOmzXKAdi5EUatWLeeoCMrGu45CeVapkmGsJ8qRemCBz62LyumRuq1ePdg9E0z2xx/F6xGoD2ISEoXn37x5s3MWhSyQmjVqaJUZuOjSK2W5bXLOihg54inRtEkT5yw5qPLbulVsz98udhdEZrjpaelK4apZs4aoWDG8rEiWF4pf+ymQ/2cFeIK8896/xPv/+rdzFsszTz0uWrZo4ZwlDhVIh6YRhfUHnzlzlrrP+Quy1PfwooO7nYbv5IVd/tRTThKH9T9UXQ/DrbffJZYtX+6cRdi5c6d44L57RLeuXZwrEX786Wfx1j/fExs3blT3wf24cE/cS4/u3ZRpqXbtWOHmhQCpl1/9u/ht7O9qkHKfkZf7bFVlJzz99FPE8QOOdT7lDyaxd9//wDkrYt99eoght9/inAUnN3eduPyqa7UDEzMtL089M0KMnzDJOYtAeZ5/7kBx8kknOFcizJu/QLz69zfEkiVLC5/fxS3POnVqi/MGnSMOPqif8z96WMP56OP/Fpv18X3pciB88/VXnSvhWZCVJe6+9wHnrIjMevXEs8OHGdv0xZddKdtJrAAfPXK4aNSooXNWMsb9Pl689/6/lfcY7TFaEXHLD1ijOv+8gaH6c7IE+Asvviz+990PhffiQps44fgBVoAnAtrKhZdc7pwVh4p/6IGhonOnjs6Vsuf9D/4jvvrqG7Fu/XrnSjDQ8A7rf4gSFkG1LlNDxa5PwweiUN/65zti/foN6jwIB/U7UFx/7VVawYeGPGr0GPHrb2OdK/FhQLj04gvV9/rxwb8/FG+/855zVkSvnvuKu++83TkLjivAvdBO/vXuW85ZEY8/+bQK/vJy7sCzxSl/O0kdz503X4x56RUluIPSuFEjcfllF6uBSAfC66yB5xcTYi7RdRmWF196VXz59TfOWREIH4LUAGF0+533qNkHVJD/cnJztfdSr25dUSnNrMicfuop4qgjj3DO9Lz1z3fFN9/8T2zSzQx8IFL67DPPUA4I8UiGAH/xZVl2sh/rOG7AMeKSiy6wNvBEQBiZOOTgg/aY8EaTuOCiy8Q7774fWngDgvGrr78V515wiZg9e45ztWSgQYwa/UIo4Q0I5xsH36Y6dzQMnldefX0o4Q1oc08986zSsFOZb779Ttx599BQwhtWr1kjHnjoUandT3SuFAcNr3evns5ZcUgBkSg64Q0XnDfIOYpo+rk5uSI7O0e9yA+kE95Au3bfp3sxKzOxfMUKMfC8i8S///NRaOENy5YtF08+9Yx44x9vF5vtlAbvyVmgSXgf1O8AJbzBCvAEmDp1unNUHGxm2L33BEwHr7vhZmXLSwZ3D31ANaJESZdT8Vdee118LTWdREHo4Fvvet7Qacjylkjnc2HRecbMWc5Z6oCA/fmX38TzY15yriQGGv78+Qucs+Icd+xfnaPiMINKBJQBHZhzvCaB0uaXX39TCoFufSMsH33yX/HMiFHOWfKh3+jMeLDvvvuIwTde75xZAR4aFlbQEHScftopzlHZgrb8xLBnnLPkQSPys/P7MWvOXPHZ5186Z4lDWf/40y/q+LEnhiU0s/Ay9P6HVL7mVILnHv5syYUGg+Ajjw9zzoqDcKhbt45zVgSf+fiTT52z4Hxv0NyPPOIw5yj56DRjIjifHj7SV2vGfNipYwexX98+qhyaNWvq/I8eBgSTkC0JKBimfsO93XvXHcr85mIFeEi+/d/3zlEs+/Xt7RyVHZgG0Jb9qJ+ZKc4+83QxasTT4oP33lavV196QfmcN2nS2FcbYhFUZ8uLx7vyc17w4uD3Dj3kYHHM0UeJrl06izq1axdrkDowwZBGYMLEyc6VCCyA8XkWS/k+zFcscAXJGfPZ5184R6kB+XW8Aqhy5coqL0gXWY50bgLEsBHr3E+jQQkh+EwH7q46Pvz4E6NZQwezpoULFzlnRVDXCMhouNaiZQvRulUr9WrTprVxcRPB6r5P9/IufvOsDz7yuHMWC+3xvnvuVDEYjzx0v7jjtpuVkHz2mWGqn5x04vFG7x+ir127fTJgEdlk4msly4d782IXMUNy+5B71Mq6Diq8rHn40SfEpMlTnLNYWFDt2KG9rwcL2RKH3HWv2LBxo3OlOHz23bff0Apa02KNC59B8BC41HPfHjHCFQ+bFStXibvuGeqrFdMxo70S8AigQdevnxnzbHzPfz/7XK0FmGjVqqV4+snHnLMi9tZFTC8MyAMGHCOqVa1abABGyOJS+NIrr4lffxvnXI2lXbu24vFHHoypUz576RXXxKw98L4Xnx8ZOJHUp599oTxkvFx4wbnixOOPc87MmLxQnnv2GdG4cSPnLD6PPfGU0e7PIjkLirp2HQ1lcvOtQ9TCqhc+z8Kkl7CLmERYI8B1sHg67PFHtAOz1cBDsnBRrFYBpgWg0mTFipVG4Y3Ae2nMc6JL506+whsaNmwgXnxhlNFNCm2KDpkIfPeY0c+qlXudZkyjRLt47eUx2um7S3RnPv64Y5WbJtq27tmqVq0izjjtFHHlFZc6V2IJuwi4t0AZPnT/veKM008VNapXj5k9cY5/+c033VDotaKDzUR01KhRQw1WXhiE//XBh85ZfHSDIDOGAcfo7exeTNaOAo2vugn6qkl44xaI22w84Q2UyRgGLzm78YJrbEm1cBZVTcK7bZs2YvhTTxhnVVaAh8DraxsNGk1Z84yPTXTIbbdoG5wJBCFCkcaqw+RN4Aff+eB990otub5zxQzugk88+pBzZoYFsIsvPN858+foI/8iB479nbNY8KNONZgFYDIJAq6H3Qzuf7qAIRfTQjxtwF1Q9mPRosUqaMxLm9at4ioTyeSjj/V2e5Stk08s7lMfhIsM7a4ki+KYxnBr1EEQ2sMPDnXO9FgBHgKmpyYBXlsTVVeaMK0zZSY85eQTRYcO7Z2zcAw8+0znqDj8Fm5aYbj26itEZmbw3M1Mz/fp0d05i4XOb7LRmjjlb+bIVdzCUgnSMjCjCsMZp/7NOYpluZzB6cDm28NQD7gxxmPs7+Odo+Iwawii8SYLk2A93adM/MB9TxfZi19+IrC+RCCaDpSv558boWYtflgBHgIan6kBbk2S+15QMCkQAuyFqdYJsqMnyjF/Pcr4jF9/G9wlEHNImIgzFz8BjvZNaHMY2rdr5xzFwiCYKtCRB50TPg9O+/bm59eGuDsc9ZfDnaPi/PDTz86Rmf9++rlzVASLzTrTTGlBvMCGDbGxB5jXWOxNlP79Y9s0OZHC8sWXXxs9vBo0qC+eHvZ4oMV4K8BD4Le6zw7UZUnWwoXa2QCLWmHzf3ghoZaOiR4vED/8BKcfjRqZF6iIEE0EvBp0mEwIeyPY+/3anwm/iFo/XRiPHt1APnfuPN9gGWzOOvPJqaee7ByVDaaF4MP791d/WaQN+8J8hBnIi2k9QU8FFRrPIrMJZppBFRUrwEOSmZnpHBWHHUPKkoULFztHxWnZskWJgyT69O7lHBUHlyyTCclLotGoJNjSgTbit8jph8mun0q0a9vGODOKR7xpuAncTHU8O2q0cxSLTvsG3BzLEpOn2Hc//KgSZV1+1XWhX3jnvPJarGeNTtM38cWXX4nnnh/jnOlZvXqNGP3Ci86ZP1aAh6SPwduECC9cxsqK9YZGgwAvKbjm6WANIMgiFjRtmtyMcUGSW5VnmjX1DyzxI+ig6+WA/ffT5qKZOm2GVgvndxYuilUsmAGRMK0sWbdO3xeZHaCIJPrSeZyEmckFtZejpQfR7K0AD8nhh0emYDqmTJ3mHJU+pkaTyDTbC8mEdJD6NSiJpF71g/S3qUiYMvMjUe27JDCNb60xGaCsLNa4YU6YOEkr4AbfeJ1zVHYUFCSn3PcUDIY3DL41rsJkBXhICIoxLS68/0FiYeeJQO5sHWGTRukwbRyLaaak5pk/G2htqYxJ+L78Sqz3BJkHvaB5N2nc2DkrO6pVSzyHeVlCvnZThkiEt2nDGBfbGxPA5KKHmx3htWUBe2jqmDc/MZemaEzJjjIqZ/xpBXiiZojly1c4R6kJAli3IL14yRIVSObCsS5PTd++vffI7MHUPwgsI+0CKWeT9RoQMDjJC31pyO23invvHmKcsZKDxtQfwQrwBDjhuAHOUSz4diYrI6AfXbro/YHR+Py8BILw/Q/67HNduwYLICmPJBptN236DOcodTnS4FL4+ZdfOUdCTJ4y1TkqDsFEewKTH7tKbXDZxeKqKy5L2uvSSy50vj04DGqPP/pgoV+/X3AaiepMJlMrwBOgb59eRtc03I1UWtctbFFVena4unXqaheYyAOis08GBU1q0eIlzllxDj/MbP8vL5giBfEMSIQffozvN723g5apY+y4350joXLPeCF9gikRVGlj8oLCLLE3DKpDpdZNmLzLEYf3N+6axMzGlEbYCvAEIcrQBFowW42ZPEXCMHvOXJUfmHwJ0V4ubJXFnoI6hj013DkKD0l1dNARvVuklUd0+1QCOci92RDj8ejjw0Jl8NtbYapPbhkvrLcQ7UheGV2Urt9MNVHClCfpYXUkmiI5WbBloG6GgCZvckL4/oefxFSNk4QV4AlC6krSopogj/XV195oTKYThLvvvV+9yA9MvoQbBt9SGH3JFGygITKPrIIvjHnZOQsOO6/gSaDjqL/4b1NVXjC5UAL5yIMuSpIv2lSWqciAY4/RzvhI9fvOe/qsjx0NArQkhHHVNW2fN2v2HPH6P2IzQZYF7KSDtq2DADxS25ogp7kXK8BLAEl/yKRnAnMK6SxvG3J34aYE8UCboVOcec55SvuOBvNI9C45NAT2OtRB2HsYIY4989lRzztnsZx00vHOUfmmVcuWzlEsmMTYu9FkYgLewzZyus6WyuCHr/MmycnJFRMnxWbEPOuM00qUuIqIYh3jxwdXiNh3UzfoAIuDYTVx3ITvGfqAuOOue5VGnAjxgspIVGbKbMraGvIkGivAS8jDD96n0nr6wWYEI0Y+J047c6AY9vQIVfnkTyBfMAKblLDss0cO5MG33qG2sDL5f2bLDhONKUMaIMSvuuYGMWfuPO0iHNo8SapolDq3MJcLzz9XbQrxZwBBRa5wE5gKbrltiMrbzZSWfRZZNyBA49XX3hCnnzWo2DZye8IDo7S4+KLYtsaA5W2rCO4zpQAvCY0MOb/JiDhz1myV62Tr1jyVo5v+RWIy3ZrTXUNuc45iweGAGS5b95lMMywe0kfYT/XBhx9T2jteISOfez7BJFbx18Vuu+UmY7thRs/zutgNHZIAjYmk/brkUn5QSWEXOp947GEVVh0N9nFTSkrgdwinri4HmubNmio7G40SUwtBGX73gKlo2BOPGBtUkF3pw0BKgkcee9I5K6JpkyZi5Iji2kdQ7nvwEbWtlhcyL56myUy3Zs1acfV1Nzpn/rjlYipDtCldznY+l+iu9GE5e9AFajbohem6yVvDBAv0bJ7tB/VO/ZeED2SbftunTdOeKUMGD9dDg+jfkcNj20i8TU+w8fN97BBFnAf5YwiPR/HBXXL79h1aAc8MGHu2jpLuSj912nQ1YJja1VtvvKriUSpWqlh+NISgVE2i8AYi1t547aWYraLiEVZ4k4TeK7zh1FNONrp6Ab+DoCa8mBV4GjNaB2HFfvdAY/YT3uUVfIX9siJGQ/mZyhDf3osuOM85Kx/89egjnSMzxw04xjlKnIMP0tuvXVCWaNPR7nUoJbpoaLTwnj59E+FMX6BfoJW/9vo/xH8++kSZMDFbmrTzkmQ1jAfBPX5OA2NeekX9rdiwelrSBdreDM9bGuIIWxt76V1w3iCVsjKZkF5y9Mjhvknor77ycuUpkKxAmx7du4lHH37gTye8gWceKrXTIBtRmCDC7rlnn95jbnSlxWGadKrR8LzkUCkprO1gww6LKa3zPbJv4taYLMjWyIYhpQmzGNqRDtbUGFhUbx99QuKJclKNq/YLvsFAIrAJ6ksvPCdOPin8jh9eSOrORqsIb9KJxuPss84I/F4TdEDs+vfde5dzJTHCzi5KlQTvZeTwYcV8dYNCFOCY0aOUS2KycqHsLeXJMx1+2KHOWSyJpvzVgTIUVss1uQ4C+7Ky61NJFCwWIdni7KYbYvc5LQ0uv/Ri5ygW1l+UAO/WsIoYenjDpNqF9zYwFQ0+qL44oVPpZ7XDhkZDfvP1V5XbENPxoCvybqgvoy97WtIgw2jVrrbObABbW5C8wtwbtlo2eWV37jCpYPFH15Fo9jkS/3tBIzZpIkGgTHX4LVYCdtEnH39Y3HDdNaKDz8YILkTVYRMd8cyThULCtFOTKVeHKWVu4xLkE2HdQ0cDQ7nE4zzZtnVtknoiyC1Z8BuPSGWCvhSvHdPHHpMzxnizJrY+pF9ed81Vqs0H6ZfUJS6JLC6+/uqLapPheDRsqL+PsDt3oenr3CG5b/awrSBH9mJD+8SV28TqLbtKxcywp8isVkkc0Dy52fESgcWfadNmiKVLl4nsnByxW06BMqSQwD0Ln9n9+vYOLOjDwCLr5ClTVIQmO/lgN8Tbopns2N27dlV/EwWXurvuuU/ZI4EF0pPlLMTkox4EPGK++ubbQu8GzFMMaH7alR88/40331aYt5kyxiZ65x23qvOg0FV+GztOzF+QpfyRua9GUghyX37rH3gO4MXgLiRSRoROs/uRF6LuBt9yu7pnQIhhD01kR3wXvDWuvWFwoQ87z09bQyNNBPK7kCnPi2kRMVnMnj1H/Dbud+X1Q7m4axUlNdnwPNNnzows7G/YKAfudCloa6vUzD177qNVKoJw2ZXXFqa1ZXDDRfWJxx4K3cexwxMD4vrA036uueoKqaAdHCvALZaw0MBy1+WqhSUaO3tblhQaPl4yaMGZ9TJLvK7AveFyhjslnZOAnbK07yM83UyRdevV9d01CUGPf/XWvK1Ju1cGWARA3rY8lYYhzF6lXq65/iZtaoGnnnxUeS1ZIlCPlPnmLVtUvyhJPfJda9dmq8XWTPk97qBiBbjFYgkMnhn4TntBG35+1AjnzFJWlF+jt8ViSTqmrb4O2C95Hh6W4FgBbrFYioGpyZsugIhhgpuwE+s49ZTEgowsJcOaUCwWSyGkemCh1gV/bDIx+uVDJ83wddfoIxItpYvVwC0Wi+I/H35cTHgDEbt+whtPnEEDE/c4spQMK8AtFosC98iwENBCwJllz2AFuMViUYSN4D130DlJCZu3JI61gVsslkIuuOiyuHu6Ekjy2CMPijatrc/3nsYKcIvFUoi7ZyQ7CpFOlYAigk8I/CFVQL8DD1CJzkwbJVjKFivALRaLJUWxNnCLxWJJUawAt1gslhTFCnCLxWJJUawAt1gslhTFLmImge07dohVa7LF1rxtahUfN6vaNWuIJo0axN2MYf2GTSJn/XqRTz5tWRPkIq5Xu7ZoUN8/3eeKVWvEug0bRdtWzUX1auZc5/MXLpH3UEG0a63fvCBv2zZ173nbIvtjpqVVErVqRO7dm7eYLZzmZi0W1apWEa2a++cQnzlnvsiokiHae353W/52kbV4iWjdoplxN38a5LwFi8TOqP0OTVSVvxH9bHPmL5StWojO7ds6V4pYuGSZ+v0uHdr61sv02fNEndq1RIum/pso5K7bIHLXb1D1D+R2r1e3tqhfL/HAFtrPoqXLxRbZlirJe2yQWU80NmwOEIR8+bwrVq9V9ezWb80a1UXjBg1Eenqa8y49tIk12Tkij3Yt6z5dtms2Vmgap11v3rJVLFm+UtUL9ePHho2bxNKVq2SdtFPfb4L7n79oiWjXqkVhu1mbkytfkRzZfhT8USC6dWxf2J55JuquY7s2qjxM8JtrsklBHHn+wn7duKGo6JMWFjmwcOky0TAzUzRqkOlcjWXF6jVig+z/3Trr89zT35atXC22yPLk9ynz6tWqiob1M9VfqHSfRB1ZQlMgO8QC2ahmSGFFQ9yxa6fYuXOXqnga1+JlK9TOK9WrVo3JA8xO1xOmzpAVtEps2ZondsnPIQho/KtlA1sqO0C9OrVFRkZl5xPFofJpXPxu8yZ6QYMg5P7y5W81a9wocjGKlbJjT5k5R2zctFnlG96+Y6dsfHkiZ9161QGrZGSozu7C887NkgJS0qiBv1CZOXeBFEYFolmT4r+LQGFQqS8FEwOBFvk7i5YtV/fCwMYLYULZ7FD3uaPwOtI6WsDNXpClfqNlsybOlSIWSsGIwOV5GaBMzJw7XwmThoZBlPsaN3GqWLkmIhgZaCJ1t0UNhstXrRaZdeuowTgMCNgfx05Q9cBvsx0bgw6Cp3Ytc/5wE6vk/U2eMdtTv9tU/S5dsVINONH160K9zZmfJeYsWKg+S5nz4rPZuetUu65apYoUpHrFgXrivps0bKB+w48N8vtpawyWaT4bHWyV9b9w8bJi7SZ3/UaxJiensC3w2rR5ixqkuV/3Gud8vzvoIMBXrc0WzeU13eYKCEsUAe/zI8jXOs/v7RvRUE5Zi5eqsmou279pAwf6H324TcvYHX6QCb+MnyQVvI2q3nbIV17+NrFOPjPK27b8fDW4Ww08QRgdf5s4RQliCrJz+zaqohDUFCkFPm32XFUR+3TtVEwro9P/PmmaEoid5OcQhmpE57PyezfKRjhFdjzo2La1amheZssOhrAAhMW+3Tqr42io2N8nTVUNd7+ePSIXHbiv3ydPU1rF/r32UQKLW+CeaKhTpWBHM2AQcaFh/yobVe2aNdUz+fHdL+PUzGD/XsV/l849fsp0db/ctwnvTuAIXjTjvvt2Ly445E1Ha0M/jZsgzyuKg/fv7VwpYuK0mapDQlupyTEL0PG/n8eqOunWqb1zpQjKnLIHyqCu1NRdwcA9b5blOk2WHdcOkvfgp6l5YWDLXrdO9OvTU7UjoJPPW7hYHH7Q/uo8KGjyDAYI0L49I1v68Y0FBbJ+ZftD6ejZvbMUhsW3duNzv02YogRWI6npdWjXOiJY5f38IT+7fcd2NegzSKJddusUqz0yQEybNVe1OZOQc1m9NkfMmrdA1ZefsEfQT5L1F91u6GfR4osyo901lgMH/TEat44A4Ypme9B+vURljT87bRylB8WgQ5tWEQFc+Pw7xOTps9TfzHqy33WN7XfrpVLFe4BB/KC+vYr9vgsDBO3piIMPcK4UwXPwbL336SZqyvbuyhUUxNnyc7VkuTLDMc+DLL7MkVN8hDcCtkeXjiqwgUqioPlbRU4dEYxdOrYrJrzRhMZK7Y0GcUDvfZVmTAfhM3R2GgtC87B++6np53zZeWksJtDMEG45ueudK8Fg5IfePbpIbaKy/F35+/IeuJdacpp46IF9RV3DfpdlgSqP6JcUypHrkfItuh5cQAIDFdNmNEQGkzCgadPpKK/+snyoV3fQ5sVxHVkfCO7e+3QNfW8IRwQK3+WCAPAOZkGgTdDh27Rspr4TcwzlpUxksn4RXl7hDQzcCG/MTAzgfNYtZ9oIn0EgobTQhpau0KeXLQvcvua+3HLjT/R1XkH5ffJ0Jbwx6XTt2L6wXxc9fxU12PD8mGGY5ZhgcEeRw+wYBpQr6o5ZIu2JdsU98Be50qt7F9HWMRtaAZ4AFPBqOQVDE9Bpx9EwjYzGbfB95Mjq2rF0UFk9ZUWhX0yZMSdyUUN3x36Gts90MSg0Rti4KbL3oo5w4ic1oFz77huZFaDR7ZIaZ1AQbnSsXj26qpmLCQZBnXCMR706ddT+lfwGsHcppiiTicwPV2hhegoKU340XX6vSZy8KCgtCBO0We6zPMCgRxoBZmZ+JjZQSptsA7PnL1QmJx3tpfZOO0DI+wl6L+5AtHXrNvVXh9s3rQBPAOzW0L1z8N3bXZgy0vnjTS0BO2NjOZWP2IL1Wrg7RQYETFCwzcG8rEVq0ezPwx9Ki+ogZ06YhDB3BAGtFPsqC0jUS2nQtHFDNcDMnpcl1uTkip/GTVRaHGaMsLimHdZSELJBwDbMwN6udQvnij9tWzZXg02YQWJvhgVRhKd33cZEV8fEts7ZLNsLi6d99+2m6hSbOuapIKDYMcvbtGWLUszcAV2HFeAJwCa+FDDT+bAo25mP7ddLQ2cVm81MdVC1eI3Q6Fg8mSU1tiAwiKDhV5J/EeDf/TxWzJgzTy3ulBeNygQdgkUtTCDuIlo8MJdBg8zSTZ3K4iuL2HNlh8cGj509kZkQQoPZWVp6uno+6pc1BGyuu3bpBQmLfZXTadfBxIKrhLjrCqkOi9CYSuItvLqgXSPwjQOY7Jz0M+qBforp1E8YR9NHrfVUV6ZR7OGTps9Ss3fvb1kBngAs9LnTnESI574Vjbsyz2/60aldG2XbpPOziBIEbO3YcnG5y8jIEDnrNijtj8UvPCzKO3QsbLxoqPHMT27HQzDGA88gbOWmqbUOvh+Pkawly0TTRg2VacfrpeMOIkFhgDr0gD7Kno25AxMBC7A/jh2vtV1ja1ftOmDbrlgxUhbMZMoDqr5CdGtXBsTTrFHYMMugvC0IOBtiEMEBgEVM+jXrNXiUjZ04RXlJue3RCvAEwPa1Ey0mQSG+YWNwjQWvBuA34+F6hrACjjYVFKbuLGodLF+s8rPgxZSvpAtUJRjjygQ0zT5yigvjJ09XHdg0TLr+wsxy4oGWhKbLFDooE6fOVLMsNaBKgYuffWRBLVKPLIb9OmGyihsIC/bsfn1l/e7fW/Tq3lUNQgiDrMXLnHdEYMFu1+5dyhMqCNudeyuJSSloGymLpsQgh1wMOiAhuBGkJlffaPB6QmNfJvuU6z0WBBYx8byi7nCKYLbN4vHUWXPV/1sBngD15IiKmSF3XTjPD8CzAzeuoGYKbJhg8rmNBm2yd4+u6pjpcthGTwdGW1Dub1K4ubZ+F6aXaB24MsWDhk2H2NtB+GAPx8Nk1vwFxjLjfTz78pWrnSs+yC8JM0NjURx7JwOwq+HjItaiaRPx6/jJakDAL57yr1Onlvr/REAJqCs/j1bO3S1ZvqJQkwOCVBgogg7++ETzPbVqxl/PMeEqJnl5/nb0PMeESBsvLWj7zEJYSA4CsRiAUA0CGjVrDKw7BQlSi4aZODKA9S6809bJ2RQKhxXgCeBG6OHrGk+YRXcQaNGksWokQaZSuLox7SKaMahAIIIQH2ZW04mGNOkuJjso0Kmw79OZo+EeCGDYuNl/BoEZB4hESwWoT6ap2TnrjPZwnh1BT30QEZhM3Dbk9Wzp0LaV8mJi2kzwBtPpoMOCn4LA4Ew7gWgvnFbNI37x+Ol7260XBhUGM0xvJdHAKXdgMPFjybLI/wdZ/E8UFqjB1W79YEGb5+fZg94T5d6tYwel4VOnpjKO5xmFAgn52/OtAE8UFgBh3OSpyktEBwtkBEVE+3HXz6yrBCwBGgRTmGCKqyI55bSrZZywdS8sftEx8GRA29dBEBJ2Wh0IbkZ3nZsj/rEwbtI09dcLg9P8rMVKGPmFEe9tuK6Bfh45eO7QWZkG459vgkXuMGRkRLRKnXkmOkrPdf2MB1P7n8ZOKAw48kIsgrtOEm2aw0zUo3NHVYfUr0lLJIXD+MnTlEDyBmqFJdJO6qvvNK27ENnKgBEvfUNJwTEB90A3VsNk28b/GzMlz4+XSRjo/wyUDNprs3O1A/LUGXNU0JlpDQV3TyBQzobSJwgjLyYHCnO51I6YBmPzZKEJGzfRc4ulMOA99esRVl1kJyNMmvfzWTQLxmEaC1NXotiITGPBCWFBB9Fp37yP76CD6xoBC5REmwELItGh9Iz8TMH4fQQWLnKM+ggQ/Nunz5mn3kcQknchjSksHZzPohVWkJo62jwDBS6SROnx/9hxdWYfBgcGL6aB/CafK3zJ38eEoMtPgVDEzQ1vm+iy9EKIOOWlC6XH9kg5Y5rwlinmCVzv3Gkx964LpWeBEWHD87sCh+cgtDl3vay7uQvUYjB1x9oC3xsP2ggaHXXBoMniIOWkbJ2yPNEMM+vVVT7hRP/F85Ig2hKTTHbu+kj9yu+ijqhfyhDzGrDe4a1ffp+yIRUE5jvaMwvo2Ls3yJkX0aIoFgj+yOdjB3mELffO/6kQ9Og6lq/K6WmFpiLAdLEmO1u1Hxbr+H1+d5M8ZoE5oulmqKhPhKYfPC9lT6CNCcLTKe8Wso14F6Wjn5/ZGMoXEZisReBtoxQrOVtg4OnJ82uUHN5LP6KtMGP1Qt+kHiibCvJ5vBHBKIS4NDIroY9HZEO+alez5s6X97RTDWZ8jw2lLyFMVTGlULnRBUkjQLiawrWBzzBdi57u0t0rSk0LrxJCgk0QQEBwwBGHHGicVtNIybdCg/aG0gMzhOmYgTyaFp0TNyZv546GAWaGFATeBR+EEYsupiRGdNAJTNGdcy/MHtDIvKD1TJ01Rw1opiRYgO80QtMUSo9g6Ne3KFTdC8KCwdcUSu+CgGIGUyA7V/SzIBD4XHT0bVCYkSE4XLhH2gEDAcyal6UEg1+dR8OC58x588VO2eHde+RzuI4ifFzzhQ6EPj7Im2Ub8tYV98N9mcrQDaU3wWyHwdILbqy65FSEtBMVGQTSIBCE484UdbiDQj9DKD0gXBk8vdG6PDOCuWN7+fzONS9uKD0L5KSd0MGg+LOcJfFXlyaB8qe9e3+fAYyydwONrABPEgjBHXK0RvuhEyPATA3cC0Jl5y7ZyWRNMLKbhF80aAZMw+ItbqINcR9+3+l+F/D7TCWDQMPBcwLtjkdNS0uP+1m0c79FMrRLnQaOFkIwE8/hp4Wh4SGmdIMPv0tz9xuY+H++I61SWiDvAr6TAZjnT5fPH+QzftBxqQ/WIKrIWR4eQdFQn373r4PvRCABZavTCk3QLnbsdNt1RfXZeFqwW1cm+A6TOYiyRMOknfA7pvZgglkG7/ebpVAWPBflGK+P8j6lhct2Efz5C5R9Wld/0ZBPBgVIZ6p0icgVZEOBkiv8ftE9C/F/UF9+rF86ebsAAAAASUVORK5CYII="}function dameLogoJpg(){return"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"}function ausPrint(e,t){var o=window.open();if(o){var a=e.getValue();nLineaHtml=0,aHtml=[],aHtml[0]="<!doctype HTML>",aHtml[++nLineaHtml]="<html>",aHtml[++nLineaHtml]="<head>",aHtml[++nLineaHtml]="<title>Resumen de ausencias y solictudes</title>",aHtml[++nLineaHtml]='<link rel="stylesheet" type="text/css" href="/themes/imprimir.css">',aHtml[++nLineaHtml]="</head>",aHtml[++nLineaHtml]="<body>",aHtml[++nLineaHtml]='<img src="/img/logo-comunytek-claim-small.png" width=184 height=53>',aHtml[++nLineaHtml]="<br>",aHtml[++nLineaHtml]="<h2>Resumen ausencias y solicitudes de "+a+"</h2><br>",aHtml[++nLineaHtml]="<table cellpadding=3 cellspacing=3>",aHtml[++nLineaHtml]="<th>Fecha</th>",aHtml[++nLineaHtml]="<th>Dia Sem</th>",aHtml[++nLineaHtml]="<th>Tp</th>",aHtml[++nLineaHtml]="<th>Tipo</th>",aHtml[++nLineaHtml]="<th>Est</th>",aHtml[++nLineaHtml]="<th>Estado</th>",aHtml[++nLineaHtml]="<th>Notas</th>";for(var i=t.getRowCount(),r=1;r<i;r++)aHtml[++nLineaHtml]="<tr>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,1)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,2)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,3)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,4)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,5)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,6)+"</td>",aHtml[++nLineaHtml]="<td>"+t.getCell(r,7)+"</td>",aHtml[++nLineaHtml]="</tr>";aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]="<br><p>Generado "+Date()+"</p>",aHtml[++nLineaHtml]="</body></html>";var n=aHtml.join("");o.document.write(n),o.document.close()}else alert("No se ha podido abrir la nueva ventana")}function imprGenerico(e,t,o){var a=window.open("");if(a){var i=25;"number"==typeof o&&(i=o);var r=t.getRowCount(),n=t.getColCount();nLineaHtml=0,aHtml=[],aHtml[0]="<!doctype HTML>",aHtml[++nLineaHtml]="<html>",aHtml[++nLineaHtml]="<head>",aHtml[++nLineaHtml]="<title>Informe generico</title>",aHtml[++nLineaHtml]='<link rel="stylesheet" type="text/css" href="/themes/imprimir.css">',aHtml[++nLineaHtml]="</head>",aHtml[++nLineaHtml]="<body>";for(var s=0,l=1;l<r;l++){if((l-1)%i==0){s++,1===l?(aHtml[++nLineaHtml]='<img src="/img/logo-comunytek-claim-small.png" width=184 height=53>',aHtml[++nLineaHtml]="<br>"):(aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]='<p style="page-break-before: always"><img src="/img/logo-comunytek-claim-small.png" width=184 height=53"></p>'),aHtml[++nLineaHtml]='<table style="border: 0; border-collapse: collapse;" width="100%"><tr>',aHtml[++nLineaHtml]='<td style="border: 0"><h2>Listado de '+e.toUpperCase()+"</h2></d>",aHtml[++nLineaHtml]='<td  style="border: 0" align="right"><h4>Página '+s+"</h4></td></tr></table>",aHtml[++nLineaHtml]='<table cellpadding=3 cellspacing=3 width="100%">';for(var d=1;d<n;d++)aHtml[++nLineaHtml]="<th>"+t.getCell(0,d)+"</th>"}aHtml[++nLineaHtml]="<tr>";for(d=1;d<n;d++)aHtml[++nLineaHtml]="<td>"+t.getCell(l,d)+"</td>";aHtml[++nLineaHtml]="</tr>"}aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]="<br><p>Generado "+Date()+"</p>",aHtml[++nLineaHtml]="</body></html>";var c=aHtml.join("");a.document.write(c),a.document.close()}else alert("No se ha podido abrir la nueva ventana")}function printVerifInteg(e,t){var o=window.open();if(o){nLineaHtml=0,aHtml=[],aHtml[0]="<!doctype HTML>",aHtml[++nLineaHtml]="<html>",aHtml[++nLineaHtml]="<head>",aHtml[++nLineaHtml]="<title>Errores de Integridad</title>",aHtml[++nLineaHtml]='<link rel="stylesheet" type="text/css" href="/themes/imprimir.css">',aHtml[++nLineaHtml]="</head>",aHtml[++nLineaHtml]="<body>",aHtml[++nLineaHtml]='<img src="/img/logo-comunytek-claim-small.png" width=184 height=53>',aHtml[++nLineaHtml]="<br>",aHtml[++nLineaHtml]="<h2>Errores de Integridad Referencial desde "+e+"</h2><br>",aHtml[++nLineaHtml]="<table cellpadding=3 cellspacing=3>",aHtml[++nLineaHtml]="<th>Sig</th>",aHtml[++nLineaHtml]="<th>Pro</th>",aHtml[++nLineaHtml]="<th>Trb</th>",aHtml[++nLineaHtml]="<th>Año</th>",aHtml[++nLineaHtml]="<th>Mes</th>",aHtml[++nLineaHtml]="<th>sem</th>",aHtml[++nLineaHtml]="<th>Error</th>";for(var a=t.length,i=0;i<a;i++)aHtml[++nLineaHtml]="<tr>",aHtml[++nLineaHtml]="<td>"+t[i][0]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][1]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][2]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][3]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][4]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][5]+"</td>",aHtml[++nLineaHtml]="<td>"+t[i][6]+"</td>",aHtml[++nLineaHtml]="</tr>";aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]="<br><p>Generado "+Date()+"</p>",aHtml[++nLineaHtml]="</body></html>";var r=aHtml.join("");o.document.write(r),o.document.close()}else alert("No se ha podido abrir la nueva ventana")}function estadoVacImp(){if(aUsuRoles.indexOf("ADMON")<0&&aUsuRoles.indexOf("VIEW")<0)alert("Opcion reservada para Administracion");else{var e=window.open();if(e){var t=httpRequest(sRequestRegvac,"ESTADVAC",sUsuario);if(esUnError(t))e.close();else{nLineaHtml=0,aHtml=[],aHtml[0]="<!doctype HTML>",aHtml[++nLineaHtml]="<html>",aHtml[++nLineaHtml]="<head>",aHtml[++nLineaHtml]="<title>Estado de Vacaciones</title>",aHtml[++nLineaHtml]='<link rel="stylesheet" type="text/css" href="/themes/imprimir.css">',aHtml[++nLineaHtml]="</head>",aHtml[++nLineaHtml]="<body>";var o=t.length;if(t[0].toString().length<1&&(o=0),0<o)for(var a=0;a<o;a++)a%35==0&&(0==a?(aHtml[++nLineaHtml]='<img src="/img/logo-comunytek-claim-small.png" width=184 height=53>',aHtml[++nLineaHtml]="<br>"):(aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]='<p style="page-break-before: always">',aHtml[++nLineaHtml]='<img src="/img/logo-comunytek-claim-small.png" width=184 height=53>',aHtml[++nLineaHtml]="</p>"),aHtml[++nLineaHtml]="<h2>Estado de Vacaciones</h2><br>",aHtml[++nLineaHtml]="<table cellpadding=3 cellspacing=3>",aHtml[++nLineaHtml]="<th>Sig</th>",aHtml[++nLineaHtml]="<th>Nombre</th>",aHtml[++nLineaHtml]="<th>Este Año</th>",aHtml[++nLineaHtml]="<th>Años Ant</th>",aHtml[++nLineaHtml]="<th>Disponibles</th>",aHtml[++nLineaHtml]="<th>Solicitadas</th>",aHtml[++nLineaHtml]="<th>Visadas</th>",aHtml[++nLineaHtml]="<th>Aprobadas</th>",aHtml[++nLineaHtml]="<th>Disfrutadas</th>",aHtml[++nLineaHtml]="<th>Total</th>",aHtml[++nLineaHtml]="<th>Quedan</th>"),aHtml[++nLineaHtml]="<tr>",aHtml[++nLineaHtml]="<td>"+t[a][0]+"</td>",aHtml[++nLineaHtml]="<td>"+t[a][1]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][2]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][3]+"</td>",aHtml[++nLineaHtml]='<td align="right"><b>'+t[a][4]+"</b></td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][5]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][6]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][7]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][8]+"</td>",aHtml[++nLineaHtml]='<td align="right">'+t[a][9]+"</td>",aHtml[++nLineaHtml]='<td align="right"><b>'+t[a][10]+"</b></td>",aHtml[++nLineaHtml]="</tr>";aHtml[++nLineaHtml]="</table>",aHtml[++nLineaHtml]="<br><p>Generado "+Date()+"</p>",aHtml[++nLineaHtml]="</body></html>";var i=aHtml.join("");e.document.write(i),e.document.close()}}else alert("No se ha podido abrir la nueva ventana")}}function rolPersona(e){var t=oGrid.getFirstSelectedRow();if(!(t<1)&&(gPRSiglas=oGrid.getCell(t,1),"string"==typeof e))if(gPRFunction=e,gPRCambiado=!1,0!=bLoggedIn)if(aUsuRoles.indexOf("SYS")<0)alert("Opcion reservada para Sistemas");else{var o=["---","Directivos, solo consultas","Registro de Rocumentos","Administración","Dirección Financiera","Sistemas"],a=["","VIEW","REGDOC","ADMON","TODO","SYS"];oPRCombos=[],oPRWin=new Form("Entrada de roles de "+gPRSiglas,280,270);for(var i=0;i<5;i++)oPRCombos[i]=new ComboBox(oPRWin,40+30*i,50,o,a,0,"oPRComboChange(this)");oPRGuardar=new Button(oPRWin,220,20,"Guardar","oPRWinGuardar()",100),oPRSalir=new Button(oPRWin,220,150,"Salir","oPRWinSalir()",100),oPRGetData(),oPRGuardar.disable(),oPRWin.fadeIn()}else alert("No has hecho login")}function oPRComboChange(e){gPRCambiado=!0,oPRGuardar.enable()}function oPRWinSalir(){gPRCambiado&&!confirm("Los cambios realizados se perderán.\n¿Estás seguro de salir?")||oPRWin.release()}function oPRGetData(){var e=httpRequest(sRequestAdmper,"GETROL",sUsuario,gPRSiglas);if(!esUnError(e)&&""!=e[0].toString())for(var t=e[0].toString().split(","),o=0;o<t.length;o++)oPRCombos[o].setIndexByValue(t[o].trim())}function oPRWinGuardar(){for(var e="",t=0;t<5;t++){var o=oPRCombos[t].getSelectedValue();""!=o&&(0<e.length&&(e+=","),e+=o)}var a=httpRequest(sRequestAdmper,"UPDROL",sUsuario,gPRSiglas,e);esUnError(a)||(new Function(gPRFunction+"()")(),oPRWin.release())}